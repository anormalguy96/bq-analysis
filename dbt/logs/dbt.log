[0m01:54:25.176926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665DF96320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665F317F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665F317DC0>]}


============================== 01:54:25.181931 | b4e09a0c-c30e-442a-b2c9-8cc5c2928b2c ==============================
[0m01:54:25.181931 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m01:54:25.181931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '..', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'None', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir ..', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m01:54:25.203593 [info ] [MainThread]: dbt version: 1.11.0-b3
[0m01:54:25.204595 [info ] [MainThread]: python version: 3.10.0
[0m01:54:25.205598 [info ] [MainThread]: python path: C:\Users\Huawei\AppData\Local\Programs\Python\Python310\python.exe
[0m01:54:25.205598 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m01:54:25.206595 [info ] [MainThread]: Using profiles dir at ..
[0m01:54:25.207594 [info ] [MainThread]: Using profiles.yml file at ..\profiles.yml
[0m01:54:25.207594 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\dbt_project.yml
[0m01:54:25.213012 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m01:54:25.213544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b4e09a0c-c30e-442a-b2c9-8cc5c2928b2c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665BDBBAF0>]}
[0m01:54:25.336839 [info ] [MainThread]: Configuration:
[0m01:54:25.336839 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m01:54:25.337747 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:54:25.338746 [info ] [MainThread]: Required dependencies:
[0m01:54:25.339746 [debug] [MainThread]: Executing "git --help"
[0m01:54:25.378920 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:54:25.380935 [debug] [MainThread]: STDERR: "b''"
[0m01:54:25.380935 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:54:25.380935 [info ] [MainThread]: Connection test skipped since no profile was found
[0m01:54:25.381919 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:54:25.381919 [info ] [MainThread]: dbt looked for a profiles.yml file in ..\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m01:54:25.382918 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:54:25.383940 [debug] [MainThread]: Command `dbt debug` failed at 01:54:25.383940 after 0.32 seconds
[0m01:54:25.383940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665DF96320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665F28E6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665E2E3B50>]}
[0m01:54:25.383940 [debug] [MainThread]: Flushing usage events
[0m01:54:26.325953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:56:58.344105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B952F76380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9542F3FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9542F3E50>]}


============================== 01:56:58.349497 | cd59efd0-73fd-4d9d-81aa-591617847a91 ==============================
[0m01:56:58.349497 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m01:56:58.350497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m01:56:58.375005 [info ] [MainThread]: dbt version: 1.11.0-b3
[0m01:56:58.375990 [info ] [MainThread]: python version: 3.10.0
[0m01:56:58.375990 [info ] [MainThread]: python path: C:\Users\Huawei\AppData\Local\Programs\Python\Python310\python.exe
[0m01:56:58.377008 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m01:57:05.083117 [info ] [MainThread]: Using profiles dir at .
[0m01:57:05.084139 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m01:57:05.085176 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\dbt_project.yml
[0m01:57:05.085176 [info ] [MainThread]: adapter type: bigquery
[0m01:57:05.086188 [info ] [MainThread]: adapter version: 1.10.2
[0m01:57:05.090408 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m01:57:05.091405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd59efd0-73fd-4d9d-81aa-591617847a91', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B970D0B070>]}
[0m01:57:05.254880 [info ] [MainThread]: Configuration:
[0m01:57:05.255880 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:57:05.256807 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:57:05.257797 [info ] [MainThread]: Required dependencies:
[0m01:57:05.257797 [debug] [MainThread]: Executing "git --help"
[0m01:57:05.305047 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:57:05.305047 [debug] [MainThread]: STDERR: "b''"
[0m01:57:05.306035 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:57:05.307027 [info ] [MainThread]: Connection:
[0m01:57:05.308028 [info ] [MainThread]:   method: service-account
[0m01:57:05.308028 [info ] [MainThread]:   database: elmaddin-bq-demo
[0m01:57:05.309027 [info ] [MainThread]:   execution_project: elmaddin-bq-demo
[0m01:57:05.309027 [info ] [MainThread]:   schema: analytics
[0m01:57:05.309027 [info ] [MainThread]:   location: US
[0m01:57:05.310027 [info ] [MainThread]:   priority: None
[0m01:57:05.310027 [info ] [MainThread]:   maximum_bytes_billed: None
[0m01:57:05.311027 [info ] [MainThread]:   impersonate_service_account: None
[0m01:57:05.311027 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m01:57:05.312027 [info ] [MainThread]:   job_retries: 1
[0m01:57:05.312027 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m01:57:05.313030 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m01:57:05.313030 [info ] [MainThread]:   timeout_seconds: 300
[0m01:57:05.314054 [info ] [MainThread]:   client_id: None
[0m01:57:05.314054 [info ] [MainThread]:   token_uri: None
[0m01:57:05.315034 [info ] [MainThread]:   compute_region: None
[0m01:57:05.316033 [info ] [MainThread]:   dataproc_cluster_name: None
[0m01:57:05.316033 [info ] [MainThread]:   gcs_bucket: None
[0m01:57:05.317028 [info ] [MainThread]:   dataproc_batch: None
[0m01:57:05.318032 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m01:57:06.085027 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m01:57:06.085027 [debug] [MainThread]: On debug: select 1 as id
[0m01:57:06.086082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:57:07.621205 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:20c07f7c-63a7-424d-9248-1d673b4d2d83&page=queryresults
[0m01:57:11.172246 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:57:11.173253 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:57:11.173754 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:57:11.174762 [debug] [MainThread]: Command `dbt debug` succeeded at 01:57:11.174762 after 12.95 seconds
[0m01:57:11.174762 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:57:11.175832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B952F76380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B970DBCB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B970DBE530>]}
[0m01:57:11.175832 [debug] [MainThread]: Flushing usage events
[0m01:57:11.931565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:57:46.771047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F9E136380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F9F4BFC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F9F4BFEE0>]}


============================== 01:57:46.776062 | b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8 ==============================
[0m01:57:46.776062 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m01:57:46.777064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt seed --profiles-dir .', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m01:57:51.295437 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m01:57:51.296422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBAE87A30>]}
[0m01:57:51.619460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBBF59F00>]}
[0m01:57:51.760063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F9BF5AAD0>]}
[0m01:57:51.761065 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m01:57:52.737246 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m01:57:52.739324 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:57:52.740246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBBF29960>]}
[0m01:57:57.153442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBCC71150>]}
[0m01:57:57.336670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m01:57:57.357904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m01:57:57.394144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBCC651B0>]}
[0m01:57:57.394144 [info ] [MainThread]: Found 4 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m01:57:57.395162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBCBBBCA0>]}
[0m01:57:57.397661 [info ] [MainThread]: 
[0m01:57:57.398199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:57:57.399211 [info ] [MainThread]: 
[0m01:57:57.400213 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:57:57.408211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m01:57:57.409699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:58.229476 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m01:57:58.230451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:59.034335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBADD5930>]}
[0m01:57:59.035337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:57:59.042184 [debug] [Thread-1 (]: Began running node seed.bq_ecom_profile.sample_orders
[0m01:57:59.042184 [debug] [Thread-2 (]: Began running node seed.bq_ecom_profile.sample_users
[0m01:57:59.043181 [info ] [Thread-1 (]: 1 of 2 START seed file analytics.sample_orders ................................. [RUN]
[0m01:57:59.044182 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.bq_ecom_profile.sample_orders'
[0m01:57:59.044182 [debug] [Thread-1 (]: Began compiling node seed.bq_ecom_profile.sample_orders
[0m01:57:59.045187 [debug] [Thread-1 (]: Began executing node seed.bq_ecom_profile.sample_orders
[0m01:57:59.043181 [info ] [Thread-2 (]: 2 of 2 START seed file analytics.sample_users .................................. [RUN]
[0m01:57:59.060296 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.bq_ecom_profile.sample_users'
[0m01:57:59.061382 [debug] [Thread-2 (]: Began compiling node seed.bq_ecom_profile.sample_users
[0m01:57:59.062338 [debug] [Thread-2 (]: Began executing node seed.bq_ecom_profile.sample_users
[0m01:57:59.143292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:57:59.144302 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:58:02.763533 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-01T10:05:00Z"; line_number: 2 byte_offset_to_start_of_line: 49 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-01T10:05:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-02T12:00:00Z"; line_number: 3 byte_offset_to_start_of_line: 87 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-02T12:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-03T09:30:00Z"; line_number: 4 byte_offset_to_start_of_line: 125 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-03T09:30:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:58:02.792143 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 410, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 336, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 296, in _execute_model
    result = MacroGenerator(
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\bigquery\impl.py", line 683, in load_dataframe
    self.connections.write_dataframe_to_table(
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\bigquery\connections.py", line 486, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\bigquery\connections.py", line 518, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\google\cloud\bigquery\job\base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\future\polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-01T10:05:00Z"; line_number: 2 byte_offset_to_start_of_line: 49 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-01T10:05:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-02T12:00:00Z"; line_number: 3 byte_offset_to_start_of_line: 87 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-02T12:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-03T09:30:00Z"; line_number: 4 byte_offset_to_start_of_line: 125 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-03T09:30:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m01:58:02.795142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F9CFD88B0>]}
[0m01:58:02.795142 [error] [Thread-1 (]: 1 of 2 ERROR loading seed file analytics.sample_orders ......................... [[31mERROR[0m in 3.75s]
[0m01:58:02.796229 [debug] [Thread-1 (]: Finished running node seed.bq_ecom_profile.sample_orders
[0m01:58:02.797143 [debug] [Thread-7 (]: Marking all children of 'seed.bq_ecom_profile.sample_orders' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-01T10:05:00Z"; line_number: 2 byte_offset_to_start_of_line: 49 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-01T10:05:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-02T12:00:00Z"; line_number: 3 byte_offset_to_start_of_line: 87 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-02T12:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-03T09:30:00Z"; line_number: 4 byte_offset_to_start_of_line: 125 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-03T09:30:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m01:58:04.283288 [debug] [Thread-2 (]: On seed.bq_ecom_profile.sample_users: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "seed.bq_ecom_profile.sample_users"} */

    alter table `elmaddin-bq-demo`.`analytics`.`sample_users` set OPTIONS()
  
[0m01:58:04.875998 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:39fba69d-7cfb-4619-9e17-8e9af202a4f7&page=queryresults
[0m01:58:05.690337 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.bq_ecom_profile.sample_users"
[0m01:58:05.710939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f1cedc-9a92-4cc0-9c26-64b5b9427fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBE114D30>]}
[0m01:58:05.710939 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file analytics.sample_users .............................. [[32mINSERT 3[0m in 6.65s]
[0m01:58:05.711952 [debug] [Thread-2 (]: Finished running node seed.bq_ecom_profile.sample_users
[0m01:58:05.713858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:58:05.715859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:58:05.716894 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m01:58:05.716894 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m01:58:05.716894 [debug] [MainThread]: Connection 'seed.bq_ecom_profile.sample_orders' was properly closed.
[0m01:58:05.717860 [debug] [MainThread]: Connection 'seed.bq_ecom_profile.sample_users' was properly closed.
[0m01:58:05.717860 [info ] [MainThread]: 
[0m01:58:05.718860 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 8.32 seconds (8.32s).
[0m01:58:05.719858 [debug] [MainThread]: Command end result
[0m01:58:05.745284 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m01:58:05.748461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m01:58:05.757468 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m01:58:05.758468 [info ] [MainThread]: 
[0m01:58:05.759471 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:58:05.759471 [info ] [MainThread]: 
[0m01:58:05.760467 [error] [MainThread]: [31mFailure in seed sample_orders (seeds\sample_orders.csv)[0m
[0m01:58:05.761468 [error] [MainThread]:   400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-01T10:05:00Z"; line_number: 2 byte_offset_to_start_of_line: 49 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-01T10:05:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-02T12:00:00Z"; line_number: 3 byte_offset_to_start_of_line: 87 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-02T12:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-03T09:30:00Z"; line_number: 4 byte_offset_to_start_of_line: 125 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-03T09:30:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:58:05.761468 [info ] [MainThread]: 
[0m01:58:05.762470 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m01:58:05.763467 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:58:05.764474 [debug] [MainThread]: Command `dbt seed` failed at 01:58:05.764474 after 19.13 seconds
[0m01:58:05.764474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F9E136380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBBF59F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBCC67970>]}
[0m01:58:05.765489 [debug] [MainThread]: Flushing usage events
[0m01:58:06.413420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:22:58.586079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A800C23E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A8153BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A8153BF70>]}


============================== 12:22:58.590675 | 9a91379f-6061-46d0-b5ac-9192ac31e78f ==============================
[0m12:22:58.590675 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:22:58.591673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt seed --profiles-dir .', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m12:23:04.919013 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:23:04.919013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9a91379f-6061-46d0-b5ac-9192ac31e78f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9DEF38B0>]}
[0m12:23:05.454978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a91379f-6061-46d0-b5ac-9192ac31e78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9E034FA0>]}
[0m12:23:05.549060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a91379f-6061-46d0-b5ac-9192ac31e78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9CD847F0>]}
[0m12:23:05.549060 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:23:06.333847 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m12:23:08.033322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:08.033322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:08.104323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a91379f-6061-46d0-b5ac-9192ac31e78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9E698250>]}
[0m12:23:08.223320 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:23:08.240324 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:23:08.275524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a91379f-6061-46d0-b5ac-9192ac31e78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9E639870>]}
[0m12:23:08.275524 [info ] [MainThread]: Found 4 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m12:23:08.276539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a91379f-6061-46d0-b5ac-9192ac31e78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9E6C38E0>]}
[0m12:23:08.278521 [info ] [MainThread]: 
[0m12:23:08.279517 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:23:08.279517 [info ] [MainThread]: 
[0m12:23:08.280517 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:08.285518 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m12:23:08.286548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:09.223006 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m12:23:09.223006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:09.929919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a91379f-6061-46d0-b5ac-9192ac31e78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9DE3DD50>]}
[0m12:23:09.929919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:23:09.936940 [debug] [Thread-1 (]: Began running node seed.bq_ecom_profile.sample_orders
[0m12:23:09.936940 [debug] [Thread-2 (]: Began running node seed.bq_ecom_profile.sample_users
[0m12:23:09.937930 [info ] [Thread-1 (]: 1 of 2 START seed file analytics.sample_orders ................................. [RUN]
[0m12:23:09.938929 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.bq_ecom_profile.sample_orders'
[0m12:23:09.938929 [info ] [Thread-2 (]: 2 of 2 START seed file analytics.sample_users .................................. [RUN]
[0m12:23:09.939945 [debug] [Thread-1 (]: Began compiling node seed.bq_ecom_profile.sample_orders
[0m12:23:09.940931 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.bq_ecom_profile.sample_users'
[0m12:23:09.940931 [debug] [Thread-1 (]: Began executing node seed.bq_ecom_profile.sample_orders
[0m12:23:09.940931 [debug] [Thread-2 (]: Began compiling node seed.bq_ecom_profile.sample_users
[0m12:23:09.952929 [debug] [Thread-2 (]: Began executing node seed.bq_ecom_profile.sample_users
[0m12:23:13.005725 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:23:13.007636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:23:16.814072 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-01T10:05:00Z"; line_number: 2 byte_offset_to_start_of_line: 49 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-01T10:05:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-02T12:00:00Z"; line_number: 3 byte_offset_to_start_of_line: 87 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-02T12:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-03T09:30:00Z"; line_number: 4 byte_offset_to_start_of_line: 125 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-03T09:30:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m12:23:16.967429 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 410, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 336, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 296, in _execute_model
    result = MacroGenerator(
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\bigquery\impl.py", line 683, in load_dataframe
    self.connections.write_dataframe_to_table(
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\bigquery\connections.py", line 486, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\bigquery\connections.py", line 518, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\google\cloud\bigquery\job\base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\future\polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-01T10:05:00Z"; line_number: 2 byte_offset_to_start_of_line: 49 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-01T10:05:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-02T12:00:00Z"; line_number: 3 byte_offset_to_start_of_line: 87 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-02T12:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-03T09:30:00Z"; line_number: 4 byte_offset_to_start_of_line: 125 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-03T09:30:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m12:23:16.970431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a91379f-6061-46d0-b5ac-9192ac31e78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AFFF0B1F0>]}
[0m12:23:16.970944 [error] [Thread-1 (]: 1 of 2 ERROR loading seed file analytics.sample_orders ......................... [[31mERROR[0m in 7.03s]
[0m12:23:16.971950 [debug] [Thread-1 (]: Finished running node seed.bq_ecom_profile.sample_orders
[0m12:23:16.972946 [debug] [Thread-7 (]: Marking all children of 'seed.bq_ecom_profile.sample_orders' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-01T10:05:00Z"; line_number: 2 byte_offset_to_start_of_line: 49 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-01T10:05:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-02T12:00:00Z"; line_number: 3 byte_offset_to_start_of_line: 87 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-02T12:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-03T09:30:00Z"; line_number: 4 byte_offset_to_start_of_line: 125 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-03T09:30:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m12:23:18.417618 [debug] [Thread-2 (]: On seed.bq_ecom_profile.sample_users: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "seed.bq_ecom_profile.sample_users"} */

    alter table `elmaddin-bq-demo`.`analytics`.`sample_users` set OPTIONS()
  
[0m12:23:19.019958 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:fa406884-9f47-40a8-9b9d-43d3ee8ad78c&page=queryresults
[0m12:23:19.655953 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.bq_ecom_profile.sample_users"
[0m12:23:19.687939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a91379f-6061-46d0-b5ac-9192ac31e78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9ECE43D0>]}
[0m12:23:19.687939 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file analytics.sample_users .............................. [[32mINSERT 3[0m in 9.75s]
[0m12:23:19.688938 [debug] [Thread-2 (]: Finished running node seed.bq_ecom_profile.sample_users
[0m12:23:19.690935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:23:19.693192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:19.693192 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m12:23:19.693192 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m12:23:19.693192 [debug] [MainThread]: Connection 'seed.bq_ecom_profile.sample_orders' was properly closed.
[0m12:23:19.694198 [debug] [MainThread]: Connection 'seed.bq_ecom_profile.sample_users' was properly closed.
[0m12:23:19.694198 [info ] [MainThread]: 
[0m12:23:19.695119 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 11.41 seconds (11.41s).
[0m12:23:19.695591 [debug] [MainThread]: Command end result
[0m12:23:19.735195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:23:19.738189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:23:19.744879 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m12:23:19.744879 [info ] [MainThread]: 
[0m12:23:19.745486 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:23:19.746500 [info ] [MainThread]: 
[0m12:23:19.747040 [error] [MainThread]: [31mFailure in seed sample_orders (seeds\sample_orders.csv)[0m
[0m12:23:19.747040 [error] [MainThread]:   400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3; errors: 3; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-01T10:05:00Z"; line_number: 2 byte_offset_to_start_of_line: 49 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-01T10:05:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-02T12:00:00Z"; line_number: 3 byte_offset_to_start_of_line: 87 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-02T12:00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2025-09-03T09:30:00Z"; line_number: 4 byte_offset_to_start_of_line: 125 column_index: 2 column_name: "order_ts" column_type: DATETIME value: "2025-09-03T09:30:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m12:23:19.748224 [info ] [MainThread]: 
[0m12:23:19.748224 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:23:19.749234 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:23:19.750759 [debug] [MainThread]: Command `dbt seed` failed at 12:23:19.750759 after 21.29 seconds
[0m12:23:19.750759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A800C23E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9E034FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9E6824A0>]}
[0m12:23:19.751766 [debug] [MainThread]: Flushing usage events
[0m12:23:20.484006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:35.769793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BCCB76320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BCDEFBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BCDEFBEB0>]}


============================== 12:31:35.775811 | 3c8259d5-271e-4608-b8fd-fb84d26f9ee4 ==============================
[0m12:31:35.775811 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:31:35.776792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'None', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m12:31:41.045636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c8259d5-271e-4608-b8fd-fb84d26f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BC9F4D390>]}
[0m12:31:41.150638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c8259d5-271e-4608-b8fd-fb84d26f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BCAB6DF00>]}
[0m12:31:41.151641 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:31:42.003349 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m12:31:42.179312 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:31:42.181229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c8259d5-271e-4608-b8fd-fb84d26f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BCA970880>]}
[0m12:31:44.242748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c8259d5-271e-4608-b8fd-fb84d26f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEB654130>]}
[0m12:31:44.359748 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:31:44.363768 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:31:44.400720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c8259d5-271e-4608-b8fd-fb84d26f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEB689C60>]}
[0m12:31:44.401735 [info ] [MainThread]: Found 4 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m12:31:44.402719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c8259d5-271e-4608-b8fd-fb84d26f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEB655780>]}
[0m12:31:44.405734 [info ] [MainThread]: 
[0m12:31:44.405734 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:44.406736 [info ] [MainThread]: 
[0m12:31:44.407715 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:31:44.414740 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m12:31:44.414740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:45.173149 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m12:31:45.174161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:45.850518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c8259d5-271e-4608-b8fd-fb84d26f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEA7ED180>]}
[0m12:31:45.850518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:45.860773 [debug] [Thread-1 (]: Began running node seed.bq_ecom_profile.sample_orders
[0m12:31:45.861795 [debug] [Thread-2 (]: Began running node seed.bq_ecom_profile.sample_users
[0m12:31:45.862837 [info ] [Thread-1 (]: 1 of 2 START seed file analytics.sample_orders ................................. [RUN]
[0m12:31:45.864540 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.bq_ecom_profile.sample_orders'
[0m12:31:45.863527 [info ] [Thread-2 (]: 2 of 2 START seed file analytics.sample_users .................................. [RUN]
[0m12:31:45.865558 [debug] [Thread-1 (]: Began compiling node seed.bq_ecom_profile.sample_orders
[0m12:31:45.866552 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.bq_ecom_profile.sample_users'
[0m12:31:45.867535 [debug] [Thread-1 (]: Began executing node seed.bq_ecom_profile.sample_orders
[0m12:31:45.868538 [debug] [Thread-2 (]: Began compiling node seed.bq_ecom_profile.sample_users
[0m12:31:45.887634 [debug] [Thread-2 (]: Began executing node seed.bq_ecom_profile.sample_users
[0m12:31:45.985635 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:31:45.988626 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:31:51.066608 [debug] [Thread-1 (]: On seed.bq_ecom_profile.sample_orders: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "seed.bq_ecom_profile.sample_orders"} */

    alter table `elmaddin-bq-demo`.`analytics`.`sample_orders` set OPTIONS()
  
[0m12:31:51.470432 [debug] [Thread-2 (]: On seed.bq_ecom_profile.sample_users: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "seed.bq_ecom_profile.sample_users"} */

    alter table `elmaddin-bq-demo`.`analytics`.`sample_users` set OPTIONS()
  
[0m12:31:51.608537 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:2f2d7ac1-20f8-4454-a752-214bba882f39&page=queryresults
[0m12:31:52.060964 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:85af0f2c-0458-4c6a-bd8d-7bc6ada78783&page=queryresults
[0m12:31:52.225576 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.bq_ecom_profile.sample_orders"
[0m12:31:52.251576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8259d5-271e-4608-b8fd-fb84d26f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEB6BD840>]}
[0m12:31:52.252578 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file analytics.sample_orders ............................. [[32mINSERT 3[0m in 6.38s]
[0m12:31:52.253578 [debug] [Thread-1 (]: Finished running node seed.bq_ecom_profile.sample_orders
[0m12:31:52.702585 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.bq_ecom_profile.sample_users"
[0m12:31:52.705585 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8259d5-271e-4608-b8fd-fb84d26f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEC713250>]}
[0m12:31:52.706592 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file analytics.sample_users .............................. [[32mINSERT 3[0m in 6.84s]
[0m12:31:52.707594 [debug] [Thread-2 (]: Finished running node seed.bq_ecom_profile.sample_users
[0m12:31:52.710493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:52.713492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:52.713492 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m12:31:52.713492 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m12:31:52.714492 [debug] [MainThread]: Connection 'seed.bq_ecom_profile.sample_orders' was properly closed.
[0m12:31:52.714492 [debug] [MainThread]: Connection 'seed.bq_ecom_profile.sample_users' was properly closed.
[0m12:31:52.714492 [info ] [MainThread]: 
[0m12:31:52.715545 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m12:31:52.717585 [debug] [MainThread]: Command end result
[0m12:31:52.751555 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:31:52.754584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:31:52.761587 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m12:31:52.762495 [info ] [MainThread]: 
[0m12:31:52.763499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:52.764525 [info ] [MainThread]: 
[0m12:31:52.765495 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:31:52.767496 [debug] [MainThread]: Command `dbt seed` succeeded at 12:31:52.766496 after 17.16 seconds
[0m12:31:52.767496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BCCB76320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEA9965F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEB68B790>]}
[0m12:31:52.768583 [debug] [MainThread]: Flushing usage events
[0m12:31:53.513782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:11.253053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B2006380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B338BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B338BEE0>]}


============================== 12:32:11.258046 | a8655896-31e8-4fc3-a48e-e07d054704e0 ==============================
[0m12:32:11.258046 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:32:11.259046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m12:32:15.571819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8655896-31e8-4fc3-a48e-e07d054704e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B2351D80>]}
[0m12:32:15.664825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8655896-31e8-4fc3-a48e-e07d054704e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7CED244C0>]}
[0m12:32:15.665821 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:32:16.293904 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m12:32:16.545915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:32:16.546945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:32:16.623917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8655896-31e8-4fc3-a48e-e07d054704e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D04C8130>]}
[0m12:32:16.757914 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:32:16.760883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:32:16.793594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8655896-31e8-4fc3-a48e-e07d054704e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D0438670>]}
[0m12:32:16.794580 [info ] [MainThread]: Found 4 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m12:32:16.795575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8655896-31e8-4fc3-a48e-e07d054704e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D046A260>]}
[0m12:32:16.797598 [info ] [MainThread]: 
[0m12:32:16.798590 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:32:16.798590 [info ] [MainThread]: 
[0m12:32:16.799576 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:16.806489 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m12:32:16.807497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:17.519249 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m12:32:17.520163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:18.318667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8655896-31e8-4fc3-a48e-e07d054704e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7CED536A0>]}
[0m12:32:18.318667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:18.328177 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.stg_events
[0m12:32:18.329151 [debug] [Thread-2 (]: Began running node model.bq_ecom_profile.stg_orders
[0m12:32:18.329151 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.stg_events .............................. [RUN]
[0m12:32:18.330152 [info ] [Thread-2 (]: 2 of 3 START sql table model analytics.stg_orders .............................. [RUN]
[0m12:32:18.332154 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.stg_events'
[0m12:32:18.333149 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.stg_orders'
[0m12:32:18.334150 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.stg_events
[0m12:32:18.334150 [debug] [Thread-2 (]: Began compiling node model.bq_ecom_profile.stg_orders
[0m12:32:18.345154 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.stg_events"
[0m12:32:18.351243 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_ecom_profile.stg_orders"
[0m12:32:18.354154 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.stg_events
[0m12:32:18.367152 [debug] [Thread-2 (]: Began executing node model.bq_ecom_profile.stg_orders
[0m12:32:18.386154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:18.391150 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:32:19.160726 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.stg_events"
[0m12:32:19.163717 [debug] [Thread-1 (]: On model.bq_ecom_profile.stg_events: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.stg_events"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`stg_events`
      
    
    

    
    OPTIONS()
    as (
      
SELECT
  event_id,
  user_id,
  TIMESTAMP(event_ts) AS event_ts,
  event_name,
  JSON_EXTRACT_SCALAR(TO_JSON_STRING(properties), '$.product_id') AS product_id,
  SAFE_CAST(JSON_EXTRACT_SCALAR(TO_JSON_STRING(properties), '$.price') AS FLOAT64) AS price
FROM `elmaddin-bq-demo`.`raw`.`events`
    );
  
[0m12:32:19.178556 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_ecom_profile.stg_orders"
[0m12:32:19.180477 [debug] [Thread-2 (]: On model.bq_ecom_profile.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.stg_orders"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`stg_orders`
      
    
    

    
    OPTIONS()
    as (
      
SELECT
  order_id,
  user_id,
  TIMESTAMP(order_ts) AS order_ts,
  total_amount,
  currency
FROM `elmaddin-bq-demo`.`raw`.`orders`
    );
  
[0m12:32:19.814610 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:b02130d2-edda-4831-8714-81e0bee0df9c&page=queryresults
[0m12:32:19.847267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:2a8f59d3-8651-46f6-88f2-6c04c17ce435&page=queryresults
[0m12:32:22.348822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8655896-31e8-4fc3-a48e-e07d054704e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C9F068F0>]}
[0m12:32:22.349868 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.stg_events ......................... [[32mCREATE TABLE (3.0 rows, 125.0 Bytes processed)[0m in 4.01s]
[0m12:32:22.350845 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.stg_events
[0m12:32:22.351793 [debug] [Thread-4 (]: Began running node model.bq_ecom_profile.mart_funnels
[0m12:32:22.352786 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.mart_funnels ............................ [RUN]
[0m12:32:22.353839 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_funnels'
[0m12:32:22.354780 [debug] [Thread-4 (]: Began compiling node model.bq_ecom_profile.mart_funnels
[0m12:32:22.358777 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_funnels"
[0m12:32:22.360782 [debug] [Thread-4 (]: Began executing node model.bq_ecom_profile.mart_funnels
[0m12:32:22.365778 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_funnels"
[0m12:32:22.367777 [debug] [Thread-4 (]: On model.bq_ecom_profile.mart_funnels: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_funnels"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_funnels`
      
    
    

    
    OPTIONS()
    as (
      
WITH steps AS (
  SELECT
    user_id,
    MIN(IF(event_name='view_product', event_ts, NULL)) AS first_view,
    MIN(IF(event_name='add_to_cart', event_ts, NULL)) AS first_add,
    MIN(IF(event_name='begin_checkout', event_ts, NULL)) AS first_checkout,
    MIN(IF(event_name='purchase', event_ts, NULL)) AS first_purchase
  FROM `elmaddin-bq-demo`.`analytics`.`stg_events`
  GROUP BY user_id
)
SELECT
  user_id,
  first_view, first_add, first_checkout, first_purchase,
  CASE
    WHEN first_purchase IS NOT NULL THEN 'purchased'
    WHEN first_checkout IS NOT NULL THEN 'checkout'
    WHEN first_add IS NOT NULL THEN 'added'
    WHEN first_view IS NOT NULL THEN 'viewed'
    ELSE 'none'
  END AS funnel_stage
FROM steps
    );
  
[0m12:32:22.368810 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:32:22.400829 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8655896-31e8-4fc3-a48e-e07d054704e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D04CF340>]}
[0m12:32:22.401877 [info ] [Thread-2 (]: 2 of 3 OK created sql table model analytics.stg_orders ......................... [[32mCREATE TABLE (3.0 rows, 87.0 Bytes processed)[0m in 4.07s]
[0m12:32:22.403875 [debug] [Thread-2 (]: Finished running node model.bq_ecom_profile.stg_orders
[0m12:32:23.362810 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:f1fe7f22-5181-44ac-a89f-b773483ea591&page=queryresults
[0m12:32:25.666737 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8655896-31e8-4fc3-a48e-e07d054704e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D068D5A0>]}
[0m12:32:25.668737 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.mart_funnels ....................... [[32mCREATE TABLE (2.0 rows, 77.0 Bytes processed)[0m in 3.31s]
[0m12:32:25.670736 [debug] [Thread-4 (]: Finished running node model.bq_ecom_profile.mart_funnels
[0m12:32:25.673737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:32:25.678738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:25.679735 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m12:32:25.679735 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m12:32:25.680737 [debug] [MainThread]: Connection 'model.bq_ecom_profile.stg_events' was properly closed.
[0m12:32:25.680737 [debug] [MainThread]: Connection 'model.bq_ecom_profile.stg_orders' was properly closed.
[0m12:32:25.681736 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_funnels' was properly closed.
[0m12:32:25.682734 [info ] [MainThread]: 
[0m12:32:25.682734 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m12:32:25.685733 [debug] [MainThread]: Command end result
[0m12:32:25.763734 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:32:25.769737 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:32:25.787737 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m12:32:25.789737 [info ] [MainThread]: 
[0m12:32:25.790735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:25.791735 [info ] [MainThread]: 
[0m12:32:25.793734 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:32:25.795733 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:25.794733 after 14.65 seconds
[0m12:32:25.795733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B2006380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D04B3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7CED244C0>]}
[0m12:32:25.796733 [debug] [MainThread]: Flushing usage events
[0m12:32:26.432741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:38.154978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D623BD6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D624F5BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D624F5BDF0>]}


============================== 12:32:38.159977 | 2bf3d576-5f3d-4140-8675-31ea8bf8ece3 ==============================
[0m12:32:38.159977 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:32:38.160977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None'}
[0m12:32:42.675517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bf3d576-5f3d-4140-8675-31ea8bf8ece3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6419C3A30>]}
[0m12:32:42.771617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bf3d576-5f3d-4140-8675-31ea8bf8ece3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63BABE980>]}
[0m12:32:42.772523 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:32:43.443632 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m12:32:43.690540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:32:43.691538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:32:43.773625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bf3d576-5f3d-4140-8675-31ea8bf8ece3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D642098130>]}
[0m12:32:43.911522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:32:43.914568 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:32:43.962066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bf3d576-5f3d-4140-8675-31ea8bf8ece3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D64209B5B0>]}
[0m12:32:43.963062 [info ] [MainThread]: Found 4 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m12:32:43.964063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bf3d576-5f3d-4140-8675-31ea8bf8ece3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D64209AA40>]}
[0m12:32:43.966085 [info ] [MainThread]: 
[0m12:32:43.967078 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:32:43.968082 [info ] [MainThread]: 
[0m12:32:43.969083 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:43.978062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m12:32:43.978062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:44.702945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bf3d576-5f3d-4140-8675-31ea8bf8ece3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6418409D0>]}
[0m12:32:44.703996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:44.712119 [debug] [Thread-1 (]: Began running node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m12:32:44.713176 [debug] [Thread-2 (]: Began running node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m12:32:44.712119 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_events_event_id ................................. [RUN]
[0m12:32:44.715134 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012'
[0m12:32:44.716218 [debug] [Thread-1 (]: Began compiling node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m12:32:44.714207 [info ] [Thread-2 (]: 2 of 2 START test unique_stg_events_event_id ................................... [RUN]
[0m12:32:44.732229 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438'
[0m12:32:44.733132 [debug] [Thread-2 (]: Began compiling node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m12:32:44.747129 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438"
[0m12:32:44.752174 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012"
[0m12:32:44.754983 [debug] [Thread-2 (]: Began executing node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m12:32:44.778990 [debug] [Thread-1 (]: Began executing node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m12:32:44.783061 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438"
[0m12:32:44.786987 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012"
[0m12:32:44.790165 [debug] [Thread-2 (]: On test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select event_id as unique_field
  from `elmaddin-bq-demo`.`analytics`.`stg_events`
  where event_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:32:44.791165 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:32:44.792164 [debug] [Thread-1 (]: On test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from `elmaddin-bq-demo`.`analytics`.`stg_events`
where event_id is null



  
  
      
    ) dbt_internal_test
[0m12:32:44.792164 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:45.864895 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:bfbb73a3-ec36-49d0-85ba-c6bc37a3c02e&page=queryresults
[0m12:32:45.880010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:270f5048-9e01-4e7d-bb17-c39dfd509460&page=queryresults
[0m12:32:46.904847 [info ] [Thread-2 (]: 2 of 2 PASS unique_stg_events_event_id ......................................... [[32mPASS[0m in 2.17s]
[0m12:32:46.906797 [debug] [Thread-2 (]: Finished running node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m12:32:46.928814 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_events_event_id ....................................... [[32mPASS[0m in 2.21s]
[0m12:32:46.929803 [debug] [Thread-1 (]: Finished running node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m12:32:46.932318 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:32:46.934317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:46.934317 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m12:32:46.934317 [debug] [MainThread]: Connection 'test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012' was properly closed.
[0m12:32:46.935317 [debug] [MainThread]: Connection 'test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438' was properly closed.
[0m12:32:46.935317 [info ] [MainThread]: 
[0m12:32:46.936317 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m12:32:46.937318 [debug] [MainThread]: Command end result
[0m12:32:46.970325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:32:46.975319 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:32:46.984318 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m12:32:46.985317 [info ] [MainThread]: 
[0m12:32:46.987320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:46.988323 [info ] [MainThread]: 
[0m12:32:46.989318 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:32:46.991409 [debug] [MainThread]: Command `dbt test` succeeded at 12:32:46.991409 after 8.95 seconds
[0m12:32:46.991409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D623BD6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D623F50E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D64209A5C0>]}
[0m12:32:46.992418 [debug] [MainThread]: Flushing usage events
[0m12:32:47.628853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:48.082303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC57646350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC589CFC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC589CFDF0>]}


============================== 12:36:48.089389 | ab2cb92b-b05a-451f-8077-5cde814da22d ==============================
[0m12:36:48.089389 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:36:48.090287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m12:36:52.980925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab2cb92b-b05a-451f-8077-5cde814da22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC742F0E20>]}
[0m12:36:53.066926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab2cb92b-b05a-451f-8077-5cde814da22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC57996680>]}
[0m12:36:53.066926 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:36:53.620926 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m12:36:53.846926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:36:53.846926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:36:53.920927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab2cb92b-b05a-451f-8077-5cde814da22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC75B08130>]}
[0m12:36:53.961612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab2cb92b-b05a-451f-8077-5cde814da22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC75B0B7C0>]}
[0m12:36:53.961612 [info ] [MainThread]: Found 4 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m12:36:53.962627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab2cb92b-b05a-451f-8077-5cde814da22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC75B0B820>]}
[0m12:36:53.965626 [info ] [MainThread]: 
[0m12:36:53.966611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:36:53.966611 [info ] [MainThread]: 
[0m12:36:53.967633 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:36:53.975630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m12:36:53.976635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:54.693118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab2cb92b-b05a-451f-8077-5cde814da22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC742E2590>]}
[0m12:36:54.694073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:36:54.701068 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohorts
[0m12:36:54.702091 [debug] [Thread-2 (]: Began running node model.bq_ecom_profile.stg_events
[0m12:36:54.703251 [debug] [Thread-3 (]: Began running node model.bq_ecom_profile.stg_orders
[0m12:36:54.703251 [debug] [Thread-4 (]: Began running node seed.bq_ecom_profile.sample_orders
[0m12:36:54.704280 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohorts'
[0m12:36:54.705261 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.stg_events'
[0m12:36:54.706263 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.stg_orders'
[0m12:36:54.707261 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.bq_ecom_profile.sample_orders'
[0m12:36:54.708021 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohorts
[0m12:36:54.708729 [debug] [Thread-2 (]: Began compiling node model.bq_ecom_profile.stg_events
[0m12:36:54.709268 [debug] [Thread-3 (]: Began compiling node model.bq_ecom_profile.stg_orders
[0m12:36:54.709268 [debug] [Thread-4 (]: Began compiling node seed.bq_ecom_profile.sample_orders
[0m12:36:54.720382 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohorts"
[0m12:36:54.724384 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_ecom_profile.stg_events"
[0m12:36:54.729380 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_ecom_profile.stg_orders"
[0m12:36:54.731283 [debug] [Thread-4 (]: Began executing node seed.bq_ecom_profile.sample_orders
[0m12:36:54.732333 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohorts
[0m12:36:54.733365 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:36:54.734382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:36:54.735283 [debug] [Thread-3 (]: Began executing node model.bq_ecom_profile.stg_orders
[0m12:36:54.736284 [debug] [Thread-2 (]: Began executing node model.bq_ecom_profile.stg_events
[0m12:36:54.737285 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:36:54.740285 [debug] [Thread-4 (]: Finished running node seed.bq_ecom_profile.sample_orders
[0m12:36:54.741291 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:36:54.742299 [debug] [Thread-4 (]: Began running node seed.bq_ecom_profile.sample_users
[0m12:36:54.745300 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohorts
[0m12:36:54.747288 [debug] [Thread-3 (]: Finished running node model.bq_ecom_profile.stg_orders
[0m12:36:54.749308 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.bq_ecom_profile.sample_orders, now seed.bq_ecom_profile.sample_users)
[0m12:36:54.750285 [debug] [Thread-2 (]: Finished running node model.bq_ecom_profile.stg_events
[0m12:36:54.751297 [debug] [Thread-4 (]: Began compiling node seed.bq_ecom_profile.sample_users
[0m12:36:54.754282 [debug] [Thread-4 (]: Began executing node seed.bq_ecom_profile.sample_users
[0m12:36:54.755282 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:36:54.756289 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_funnels
[0m12:36:54.758282 [debug] [Thread-4 (]: Finished running node seed.bq_ecom_profile.sample_users
[0m12:36:54.759207 [debug] [Thread-3 (]: Began running node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m12:36:54.760127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.mart_cohorts, now model.bq_ecom_profile.mart_funnels)
[0m12:36:54.761216 [debug] [Thread-2 (]: Began running node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m12:36:54.762189 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.stg_orders, now test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012)
[0m12:36:54.763194 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_funnels
[0m12:36:54.763194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.stg_events, now test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438)
[0m12:36:54.764300 [debug] [Thread-3 (]: Began compiling node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m12:36:54.768297 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_funnels"
[0m12:36:54.769300 [debug] [Thread-2 (]: Began compiling node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m12:36:54.783301 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012"
[0m12:36:54.792203 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438"
[0m12:36:54.794308 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_funnels
[0m12:36:54.795309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:54.796318 [debug] [Thread-2 (]: Began executing node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m12:36:54.796318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:36:54.799402 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_funnels
[0m12:36:54.800392 [debug] [Thread-3 (]: Began executing node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m12:36:54.801149 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:36:54.804244 [debug] [Thread-3 (]: Finished running node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m12:36:54.806257 [debug] [Thread-2 (]: Finished running node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m12:36:54.808161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:54.808161 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m12:36:54.809254 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_funnels' was properly closed.
[0m12:36:54.809254 [debug] [MainThread]: Connection 'test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438' was properly closed.
[0m12:36:54.809254 [debug] [MainThread]: Connection 'test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012' was properly closed.
[0m12:36:54.809254 [debug] [MainThread]: Connection 'seed.bq_ecom_profile.sample_users' was properly closed.
[0m12:36:54.811253 [debug] [MainThread]: Command end result
[0m12:36:54.943258 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:36:54.947186 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:36:54.956251 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m12:36:55.330181 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:36:55.330181 [info ] [MainThread]: Building catalog
[0m12:36:55.340169 [debug] [ThreadPool]: Acquiring new bigquery connection 'elmaddin-bq-demo.information_schema'
[0m12:36:55.352176 [debug] [ThreadPool]: Acquiring new bigquery connection 'elmaddin-bq-demo.information_schema'
[0m12:36:55.370267 [debug] [ThreadPool]: On elmaddin-bq-demo.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "connection_name": "elmaddin-bq-demo.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `elmaddin-bq-demo`.`raw`.__TABLES__ tables
    left join `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('orders')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('events')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('users')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:36:55.376266 [debug] [ThreadPool]: On elmaddin-bq-demo.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "connection_name": "elmaddin-bq-demo.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `elmaddin-bq-demo`.`analytics`.__TABLES__ tables
    left join `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('sample_orders')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('mart_cohorts')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('stg_orders')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('mart_funnels')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('sample_users')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('stg_events')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:36:55.378178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:55.378178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:56.373565 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:41370e4e-77e0-4319-becd-170f7ee95dbc&page=queryresults
[0m12:36:56.401003 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:d24efe4f-9a2a-418d-8770-570695de8103&page=queryresults
[0m12:36:58.550391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:36:58.571372 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\catalog.json
[0m12:36:58.603462 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:36:58.607393 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:36:58.608371 [info ] [MainThread]: Catalog written to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\catalog.json
[0m12:36:58.610370 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:36:58.610370 after 10.64 seconds
[0m12:36:58.610370 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:36:58.611388 [debug] [MainThread]: Connection 'elmaddin-bq-demo.information_schema' was properly closed.
[0m12:36:58.611388 [debug] [MainThread]: Connection 'elmaddin-bq-demo.information_schema' was properly closed.
[0m12:36:58.612390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC57646350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC57996680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC5808AD10>]}
[0m12:36:58.612390 [debug] [MainThread]: Flushing usage events
[0m12:36:59.331133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:39.524690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232320162F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023233397C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023233397EE0>]}


============================== 12:37:39.529983 | 4528f84e-06b0-4e25-bb67-a6cb36ad4a46 ==============================
[0m12:37:39.529983 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:37:39.530982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt docs serve --profiles-dir .', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m12:37:43.757924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4528f84e-06b0-4e25-bb67-a6cb36ad4a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323242F9A0>]}
[0m12:37:43.852940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4528f84e-06b0-4e25-bb67-a6cb36ad4a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002324FEA3040>]}
[0m12:48:31.783745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FCDE6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FE16FC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FE16FEE0>]}


============================== 12:48:31.793746 | b526998b-b17d-4b3d-9939-ae611a4a3bdd ==============================
[0m12:48:31.793746 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:48:31.795745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run --select mart_cohort_ltv --profiles-dir .', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m12:48:38.776919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b526998b-b17d-4b3d-9939-ae611a4a3bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019799CF6AD0>]}
[0m12:48:38.903709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b526998b-b17d-4b3d-9939-ae611a4a3bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019794ED5360>]}
[0m12:48:38.904715 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:48:40.192096 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m12:48:40.542125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:40.542632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:40.677338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b526998b-b17d-4b3d-9939-ae611a4a3bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979B498130>]}
[0m12:48:40.917884 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:48:40.924884 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:48:40.979883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b526998b-b17d-4b3d-9939-ae611a4a3bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979B4C2350>]}
[0m12:48:40.980943 [info ] [MainThread]: Found 4 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m12:48:40.981884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b526998b-b17d-4b3d-9939-ae611a4a3bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979B4C1300>]}
[0m12:48:40.983886 [warn ] [MainThread]: The selection criterion 'mart_cohort_ltv' does not match any enabled nodes
[0m12:48:40.986983 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:48:40.991984 [debug] [MainThread]: Command end result
[0m12:48:41.057985 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:48:41.062989 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:48:41.072509 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m12:48:41.073510 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:41.073510 after 9.49 seconds
[0m12:48:41.074511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FCDE6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979B320460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FD160C70>]}
[0m12:48:41.075510 [debug] [MainThread]: Flushing usage events
[0m12:48:41.885270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:27.885031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D071016320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D07239FC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D07239FEE0>]}


============================== 12:54:27.890051 | bb3a9fbe-4549-4a29-8b34-ae01793150a5 ==============================
[0m12:54:27.890051 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:54:27.890051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt run --select mart_cohort_ltv --profiles-dir .', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m12:54:31.533142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb3a9fbe-4549-4a29-8b34-ae01793150a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D06E3FD390>]}
[0m12:54:31.608440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb3a9fbe-4549-4a29-8b34-ae01793150a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0090F92D0>]}
[0m12:54:31.609440 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:54:32.107285 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m12:54:32.291662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:54:32.291662 [debug] [MainThread]: Partial parsing: added file: bq_ecom_profile://models\mart_cohort_ltv.sql
[0m12:54:32.620019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb3a9fbe-4549-4a29-8b34-ae01793150a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D00F901810>]}
[0m12:54:32.723382 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:54:32.726419 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:54:32.752326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb3a9fbe-4549-4a29-8b34-ae01793150a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D00F902A40>]}
[0m12:54:32.753352 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m12:54:32.753352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb3a9fbe-4549-4a29-8b34-ae01793150a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D00F902AD0>]}
[0m12:54:32.755328 [info ] [MainThread]: 
[0m12:54:32.755328 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:32.756327 [info ] [MainThread]: 
[0m12:54:32.757327 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:54:32.758331 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m12:54:32.759358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:33.475282 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m12:54:33.476058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:34.247617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb3a9fbe-4549-4a29-8b34-ae01793150a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D06FA21090>]}
[0m12:54:34.248618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:34.255615 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m12:54:34.255615 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.mart_cohort_ltv ......................... [RUN]
[0m12:54:34.256637 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m12:54:34.257619 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m12:54:34.264638 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m12:54:34.265632 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m12:54:34.303788 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m12:54:34.304873 [debug] [Thread-1 (]: On model.bq_ecom_profile.mart_cohort_ltv: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_cohort_ltv"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
      
    
    

    
    OPTIONS()
    as (
      

WITH user_orders AS (
    SELECT
        user_id,
        DATE_TRUNC(order_ts, DAY) AS order_date,
        signup_date,
        TIMESTAMP_DIFF(order_ts, signup_date, DAY) AS day_offset,
        amount AS revenue
    FROM `elmaddin-bq-demo`.`raw`.`events`
    WHERE event_type = 'purchase'
),

cohorts AS (
    SELECT
        DATE_TRUNC(signup_date, DAY) AS cohort_date,
        COUNT(DISTINCT user_id) AS cohort_size
    FROM `elmaddin-bq-demo`.`raw`.`events`
    WHERE signup_date IS NOT NULL
    GROUP BY 1
),

ltv_calc AS (
    SELECT
        DATE_TRUNC(u.signup_date, DAY) AS cohort_date,
        u.day_offset,
        COUNT(DISTINCT u.user_id) AS active_users,
        SUM(u.revenue) AS revenue
    FROM user_orders u
    GROUP BY 1, 2
)

SELECT
    l.cohort_date,
    l.day_offset,
    l.active_users,
    SAFE_DIVIDE(SUM(l.revenue), NULLIF(c.cohort_size, 0)) AS avg_ltv_per_user,
    l.revenue
FROM ltv_calc l
LEFT JOIN cohorts c
USING (cohort_date)
ORDER BY cohort_date, day_offset;
    );
  
[0m12:54:34.305866 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:35.226238 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:1b99f040-4942-43e7-bc08-714da494ac91&page=queryresults
[0m12:54:35.227323 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:1b99f040-4942-43e7-bc08-714da494ac91&page=queryresults
[0m12:54:35.263845 [debug] [Thread-1 (]: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Syntax error: Expected ")" but got ";" at [55:33]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m12:54:35.266844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb3a9fbe-4549-4a29-8b34-ae01793150a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D06FE83490>]}
[0m12:54:35.267871 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.mart_cohort_ltv ................ [[31mERROR[0m in 1.01s]
[0m12:54:35.268845 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m12:54:35.268845 [debug] [Thread-7 (]: Marking all children of 'model.bq_ecom_profile.mart_cohort_ltv' to be skipped because of status 'error'.  Reason: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Syntax error: Expected ")" but got ";" at [55:33]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql.
[0m12:54:35.270707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:35.272729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:35.272729 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m12:54:35.272729 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m12:54:35.273733 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_cohort_ltv' was properly closed.
[0m12:54:35.273733 [info ] [MainThread]: 
[0m12:54:35.273733 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m12:54:35.274711 [debug] [MainThread]: Command end result
[0m12:54:35.299567 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:54:35.302477 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:54:35.308477 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m12:54:35.308477 [info ] [MainThread]: 
[0m12:54:35.309480 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:54:35.310480 [info ] [MainThread]: 
[0m12:54:35.311538 [error] [MainThread]: [31mFailure in model mart_cohort_ltv (models\mart_cohort_ltv.sql)[0m
[0m12:54:35.312477 [error] [MainThread]:   Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Syntax error: Expected ")" but got ";" at [55:33]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m12:54:35.312477 [info ] [MainThread]: 
[0m12:54:35.313477 [info ] [MainThread]:   compiled code at target\compiled\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m12:54:35.313477 [info ] [MainThread]: 
[0m12:54:35.313477 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:54:35.315479 [debug] [MainThread]: Command `dbt run` failed at 12:54:35.314479 after 7.52 seconds
[0m12:54:35.315479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D071016320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0090F92D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D00DEB5B70>]}
[0m12:54:35.315479 [debug] [MainThread]: Flushing usage events
[0m12:54:36.033459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:52.274653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE15D6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE295FC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE295FEE0>]}


============================== 12:58:52.278676 | 5c5bef37-600d-4569-8529-9e4b3218bcfc ==============================
[0m12:58:52.278676 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:58:52.279654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run --select mart_cohort_ltv --profiles-dir .', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m12:58:55.622736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c5bef37-600d-4569-8529-9e4b3218bcfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE19E8490>]}
[0m12:58:55.698264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c5bef37-600d-4569-8529-9e4b3218bcfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FF94B8820>]}
[0m12:58:55.699266 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:58:56.188805 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m12:58:56.379647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:58:56.380647 [debug] [MainThread]: Partial parsing: updated file: bq_ecom_profile://models\mart_cohort_ltv.sql
[0m12:58:56.735905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c5bef37-600d-4569-8529-9e4b3218bcfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FFFCC13F0>]}
[0m12:58:56.853494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:58:56.855491 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:58:56.883519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c5bef37-600d-4569-8529-9e4b3218bcfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FFFA09150>]}
[0m12:58:56.885582 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m12:58:56.885582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c5bef37-600d-4569-8529-9e4b3218bcfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FFFA09630>]}
[0m12:58:56.887592 [info ] [MainThread]: 
[0m12:58:56.887592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:58:56.888588 [info ] [MainThread]: 
[0m12:58:56.888588 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:58:56.890588 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m12:58:56.891595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:57.662036 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m12:58:57.663037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:58.387220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c5bef37-600d-4569-8529-9e4b3218bcfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE28DE890>]}
[0m12:58:58.387220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:58.394230 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m12:58:58.395248 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.mart_cohort_ltv ......................... [RUN]
[0m12:58:58.395248 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m12:58:58.396230 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m12:58:58.403886 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m12:58:58.404887 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m12:58:58.441698 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m12:58:58.442711 [debug] [Thread-1 (]: On model.bq_ecom_profile.mart_cohort_ltv: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_cohort_ltv"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
      
    
    

    
    OPTIONS()
    as (
      

WITH user_orders AS (
    SELECT
        user_id,
        DATE_TRUNC(order_ts, DAY) AS order_date,
        signup_date,
        TIMESTAMP_DIFF(order_ts, signup_date, DAY) AS day_offset,
        amount AS revenue
    FROM `elmaddin-bq-demo`.`raw`.`events`
    WHERE event_type = 'purchase'
),

cohorts AS (
    SELECT
        DATE_TRUNC(signup_date, DAY) AS cohort_date,
        COUNT(DISTINCT user_id) AS cohort_size
    FROM `elmaddin-bq-demo`.`raw`.`events`
    WHERE signup_date IS NOT NULL
    GROUP BY 1
),

ltv_calc AS (
    SELECT
        DATE_TRUNC(u.signup_date, DAY) AS cohort_date,
        u.day_offset,
        COUNT(DISTINCT u.user_id) AS active_users,
        SUM(u.revenue) AS revenue
    FROM user_orders u
    GROUP BY 1, 2
)

SELECT
    l.cohort_date,
    l.day_offset,
    l.active_users,
    SAFE_DIVIDE(SUM(l.revenue), NULLIF(c.cohort_size, 0)) AS avg_ltv_per_user,
    l.revenue
FROM ltv_calc l
LEFT JOIN cohorts c
ON l.cohort_date = c.cohort_date
ORDER BY l.cohort_date, l.day_offset
    );
  
[0m12:58:58.443712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:59.546288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:c1fcd078-3eb5-4653-8dd2-7463dcaeb11d&page=queryresults
[0m12:58:59.853690 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:c1fcd078-3eb5-4653-8dd2-7463dcaeb11d&page=queryresults
[0m12:58:59.858722 [debug] [Thread-1 (]: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: event_type; Did you mean event_name? at [24:11]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m12:58:59.861696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5bef37-600d-4569-8529-9e4b3218bcfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FDFF9FD00>]}
[0m12:58:59.862698 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.mart_cohort_ltv ................ [[31mERROR[0m in 1.46s]
[0m12:58:59.863696 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m12:58:59.863696 [debug] [Thread-7 (]: Marking all children of 'model.bq_ecom_profile.mart_cohort_ltv' to be skipped because of status 'error'.  Reason: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: event_type; Did you mean event_name? at [24:11]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql.
[0m12:58:59.865697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:59.866696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:59.867716 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m12:58:59.867716 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m12:58:59.867716 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_cohort_ltv' was properly closed.
[0m12:58:59.867716 [info ] [MainThread]: 
[0m12:58:59.868721 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m12:58:59.869698 [debug] [MainThread]: Command end result
[0m12:58:59.895334 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m12:58:59.897394 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m12:58:59.904335 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m12:58:59.904335 [info ] [MainThread]: 
[0m12:58:59.905350 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:58:59.906377 [info ] [MainThread]: 
[0m12:58:59.907534 [error] [MainThread]: [31mFailure in model mart_cohort_ltv (models\mart_cohort_ltv.sql)[0m
[0m12:58:59.907534 [error] [MainThread]:   Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: event_type; Did you mean event_name? at [24:11]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m12:58:59.908547 [info ] [MainThread]: 
[0m12:58:59.909548 [info ] [MainThread]:   compiled code at target\compiled\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m12:58:59.909548 [info ] [MainThread]: 
[0m12:58:59.910551 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:58:59.911542 [debug] [MainThread]: Command `dbt run` failed at 12:58:59.911542 after 7.74 seconds
[0m12:58:59.911542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE15D6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE19E98D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE1952D40>]}
[0m12:58:59.912558 [debug] [MainThread]: Flushing usage events
[0m12:59:00.699810 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:40.871588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258D6B523B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258D7EAFC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258D7EAFF70>]}


============================== 13:09:40.875463 | 452c5679-a9be-4a72-8ddd-4a17f80d9c9a ==============================
[0m13:09:40.875463 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:09:40.875966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select mart_cohort_ltv --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m13:09:44.123786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '452c5679-a9be-4a72-8ddd-4a17f80d9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258D7DEA0B0>]}
[0m13:09:44.199000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '452c5679-a9be-4a72-8ddd-4a17f80d9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258EEA08A60>]}
[0m13:09:44.200002 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:09:44.696143 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:09:44.881052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:09:44.882054 [debug] [MainThread]: Partial parsing: updated file: bq_ecom_profile://models\mart_cohort_ltv.sql
[0m13:09:45.199191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '452c5679-a9be-4a72-8ddd-4a17f80d9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F5211AB0>]}
[0m13:09:45.302268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:09:45.305270 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:09:45.327282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '452c5679-a9be-4a72-8ddd-4a17f80d9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F4F58A30>]}
[0m13:09:45.328288 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m13:09:45.329280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452c5679-a9be-4a72-8ddd-4a17f80d9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258D59B5870>]}
[0m13:09:45.330299 [info ] [MainThread]: 
[0m13:09:45.330299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:09:45.331280 [info ] [MainThread]: 
[0m13:09:45.331280 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:09:45.333279 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m13:09:45.333279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:46.209519 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:09:46.210521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:46.917976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452c5679-a9be-4a72-8ddd-4a17f80d9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F521FCA0>]}
[0m13:09:46.917976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:46.923979 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:09:46.923979 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.mart_cohort_ltv ......................... [RUN]
[0m13:09:46.924978 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m13:09:46.924978 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m13:09:46.932983 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:09:46.934984 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m13:09:46.969502 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:09:46.970511 [debug] [Thread-1 (]: On model.bq_ecom_profile.mart_cohort_ltv: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_cohort_ltv"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
      
    
    

    
    OPTIONS()
    as (
      

WITH user_orders AS (
    SELECT
        user_id,
        DATE_TRUNC(order_ts, DAY) AS order_date,
        signup_date,
        TIMESTAMP_DIFF(order_ts, signup_date, DAY) AS day_offset,
        amount AS revenue
    FROM `elmaddin-bq-demo`.`raw`.`events`
    WHERE event_name = 'purchase'
),

cohorts AS (
    SELECT
        DATE_TRUNC(signup_date, DAY) AS cohort_date,
        COUNT(DISTINCT user_id) AS cohort_size
    FROM `elmaddin-bq-demo`.`raw`.`events`
    WHERE signup_date IS NOT NULL
    GROUP BY 1
),

ltv_calc AS (
    SELECT
        DATE_TRUNC(u.signup_date, DAY) AS cohort_date,
        u.day_offset,
        COUNT(DISTINCT u.user_id) AS active_users,
        SUM(u.revenue) AS revenue
    FROM user_orders u
    GROUP BY 1, 2
)

SELECT
    l.cohort_date,
    l.day_offset,
    l.active_users,
    SAFE_DIVIDE(SUM(l.revenue), NULLIF(c.cohort_size, 0)) AS avg_ltv_per_user,
    l.revenue
FROM ltv_calc l
LEFT JOIN cohorts c
ON l.cohort_date = c.cohort_date
ORDER BY l.cohort_date, l.day_offset
    );
  
[0m13:09:46.971511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:09:48.083479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:bd26ba92-562c-42dd-8a4b-602fa957209c&page=queryresults
[0m13:09:48.415369 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:bd26ba92-562c-42dd-8a4b-602fa957209c&page=queryresults
[0m13:09:48.419356 [debug] [Thread-1 (]: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: order_ts at [19:20]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:09:48.421365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452c5679-a9be-4a72-8ddd-4a17f80d9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F501C190>]}
[0m13:09:48.422381 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.mart_cohort_ltv ................ [[31mERROR[0m in 1.49s]
[0m13:09:48.423366 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:09:48.423366 [debug] [Thread-7 (]: Marking all children of 'model.bq_ecom_profile.mart_cohort_ltv' to be skipped because of status 'error'.  Reason: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: order_ts at [19:20]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql.
[0m13:09:48.425361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:09:48.427387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:48.427387 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m13:09:48.428383 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:09:48.428383 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_cohort_ltv' was properly closed.
[0m13:09:48.428383 [info ] [MainThread]: 
[0m13:09:48.429360 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m13:09:48.430365 [debug] [MainThread]: Command end result
[0m13:09:48.453461 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:09:48.455463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:09:48.462466 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:09:48.462466 [info ] [MainThread]: 
[0m13:09:48.463465 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:09:48.464474 [info ] [MainThread]: 
[0m13:09:48.465460 [error] [MainThread]: [31mFailure in model mart_cohort_ltv (models\mart_cohort_ltv.sql)[0m
[0m13:09:48.465460 [error] [MainThread]:   Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: order_ts at [19:20]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:09:48.466460 [info ] [MainThread]: 
[0m13:09:48.466460 [info ] [MainThread]:   compiled code at target\compiled\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:09:48.466460 [info ] [MainThread]: 
[0m13:09:48.467459 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:09:48.468485 [debug] [MainThread]: Command `dbt run` failed at 13:09:48.467459 after 7.69 seconds
[0m13:09:48.468485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258D6B523B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258D7DEACE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258F513D240>]}
[0m13:09:48.469486 [debug] [MainThread]: Flushing usage events
[0m13:09:49.181542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:05.374755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6D7B26380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6D8EAFC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6D8EAFF70>]}


============================== 13:12:05.377735 | d2872277-2893-418d-95a1-f5b4fd29244e ==============================
[0m13:12:05.377735 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:12:05.378732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run --select mart_cohort_ltv --profiles-dir .', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m13:12:08.630536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2872277-2893-418d-95a1-f5b4fd29244e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6F594A200>]}
[0m13:12:08.707186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2872277-2893-418d-95a1-f5b4fd29244e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6EFA25330>]}
[0m13:12:08.707186 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:12:09.203112 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:12:09.391531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:09.391531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:09.455044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2872277-2893-418d-95a1-f5b4fd29244e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6F5FEC130>]}
[0m13:12:09.564772 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:12:09.567789 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:12:09.590256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2872277-2893-418d-95a1-f5b4fd29244e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6F5F963B0>]}
[0m13:12:09.591282 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m13:12:09.591282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2872277-2893-418d-95a1-f5b4fd29244e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6F5F94520>]}
[0m13:12:09.593276 [info ] [MainThread]: 
[0m13:12:09.593276 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:12:09.593276 [info ] [MainThread]: 
[0m13:12:09.594254 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:12:09.595254 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m13:12:09.596288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:10.302333 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:12:10.302333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:11.032382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2872277-2893-418d-95a1-f5b4fd29244e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6D79D1660>]}
[0m13:12:11.033378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:11.038448 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:12:11.039444 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.mart_cohort_ltv ......................... [RUN]
[0m13:12:11.039444 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m13:12:11.040433 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m13:12:11.050436 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:12:11.051432 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m13:12:11.086681 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:12:11.087682 [debug] [Thread-1 (]: On model.bq_ecom_profile.mart_cohort_ltv: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_cohort_ltv"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
      
    
    

    
    OPTIONS()
    as (
      

WITH user_orders AS (
    SELECT
        user_id,
        DATE_TRUNC(order_ts, DAY) AS order_date,
        signup_date,
        TIMESTAMP_DIFF(order_ts, signup_date, DAY) AS day_offset,
        amount AS revenue
    FROM `elmaddin-bq-demo`.`raw`.`events`
    WHERE event_name = 'purchase'
),

cohorts AS (
    SELECT
        DATE_TRUNC(signup_date, DAY) AS cohort_date,
        COUNT(DISTINCT user_id) AS cohort_size
    FROM `elmaddin-bq-demo`.`raw`.`events`
    WHERE signup_date IS NOT NULL
    GROUP BY 1
),

ltv_calc AS (
    SELECT
        DATE_TRUNC(u.signup_date, DAY) AS cohort_date,
        u.day_offset,
        COUNT(DISTINCT u.user_id) AS active_users,
        SUM(u.revenue) AS revenue
    FROM user_orders u
    GROUP BY 1, 2
)

SELECT
    l.cohort_date,
    l.day_offset,
    l.active_users,
    SAFE_DIVIDE(SUM(l.revenue), NULLIF(c.cohort_size, 0)) AS avg_ltv_per_user,
    l.revenue
FROM ltv_calc l
LEFT JOIN cohorts c
ON l.cohort_date = c.cohort_date
ORDER BY l.cohort_date, l.day_offset
    );
  
[0m13:12:11.088682 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:12.170817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:bbc94418-f6ed-4975-af50-6bded1cabb3b&page=queryresults
[0m13:12:12.486923 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:bbc94418-f6ed-4975-af50-6bded1cabb3b&page=queryresults
[0m13:12:12.490954 [debug] [Thread-1 (]: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: order_ts at [19:20]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:12:12.493928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2872277-2893-418d-95a1-f5b4fd29244e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6D79988B0>]}
[0m13:12:12.493928 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.mart_cohort_ltv ................ [[31mERROR[0m in 1.45s]
[0m13:12:12.494927 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:12:12.494927 [debug] [Thread-7 (]: Marking all children of 'model.bq_ecom_profile.mart_cohort_ltv' to be skipped because of status 'error'.  Reason: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: order_ts at [19:20]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql.
[0m13:12:12.496928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:12.498935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:12.499934 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m13:12:12.499934 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:12:12.499934 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_cohort_ltv' was properly closed.
[0m13:12:12.500935 [info ] [MainThread]: 
[0m13:12:12.500935 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m13:12:12.501931 [debug] [MainThread]: Command end result
[0m13:12:12.525775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:12:12.527777 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:12:12.535849 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:12:12.535849 [info ] [MainThread]: 
[0m13:12:12.536855 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:12:12.537855 [info ] [MainThread]: 
[0m13:12:12.537855 [error] [MainThread]: [31mFailure in model mart_cohort_ltv (models\mart_cohort_ltv.sql)[0m
[0m13:12:12.537855 [error] [MainThread]:   Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: order_ts at [19:20]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:12:12.538854 [info ] [MainThread]: 
[0m13:12:12.538854 [info ] [MainThread]:   compiled code at target\compiled\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:12:12.538854 [info ] [MainThread]: 
[0m13:12:12.539853 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:12:12.540880 [debug] [MainThread]: Command `dbt run` failed at 13:12:12.540880 after 7.25 seconds
[0m13:12:12.540880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6D7B26380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6F5F592A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6F5F593F0>]}
[0m13:12:12.540880 [debug] [MainThread]: Flushing usage events
[0m13:12:13.280726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:46.553576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC14096320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC1541FC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC1541FEE0>]}


============================== 13:15:46.557577 | 6eb2c2c9-f6ab-42d4-a567-7c0885609268 ==============================
[0m13:15:46.557577 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:15:46.558573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --select mart_cohort_ltv --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m13:15:49.846689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6eb2c2c9-f6ab-42d4-a567-7c0885609268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC30DB5C90>]}
[0m13:15:49.920864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6eb2c2c9-f6ab-42d4-a567-7c0885609268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC30DB4190>]}
[0m13:15:49.921863 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:15:50.395708 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:15:50.579584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:50.580584 [debug] [MainThread]: Partial parsing: updated file: bq_ecom_profile://models\mart_cohort_ltv.sql
[0m13:15:50.896843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6eb2c2c9-f6ab-42d4-a567-7c0885609268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC32781510>]}
[0m13:15:50.999318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:15:51.001317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:15:51.023518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6eb2c2c9-f6ab-42d4-a567-7c0885609268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC324C8C70>]}
[0m13:15:51.024518 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m13:15:51.024518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eb2c2c9-f6ab-42d4-a567-7c0885609268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC31E881F0>]}
[0m13:15:51.026534 [info ] [MainThread]: 
[0m13:15:51.026534 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:15:51.027521 [info ] [MainThread]: 
[0m13:15:51.027521 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:15:51.028544 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m13:15:51.029522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:51.742538 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:15:51.743613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:52.495801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eb2c2c9-f6ab-42d4-a567-7c0885609268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC30D35D80>]}
[0m13:15:52.496798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:52.501799 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:15:52.502803 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.mart_cohort_ltv ......................... [RUN]
[0m13:15:52.503800 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m13:15:52.503800 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m13:15:52.510825 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:15:52.511816 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m13:15:52.546941 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:15:52.547942 [debug] [Thread-1 (]: On model.bq_ecom_profile.mart_cohort_ltv: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_cohort_ltv"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
      
    
    

    
    OPTIONS()
    as (
      

WITH user_orders AS (
    SELECT
        user_id,
        DATE_TRUNC(event_ts, DAY) AS order_date,
        signup_date,
        TIMESTAMP_DIFF(event_ts, signup_date, DAY) AS day_offset,
        amount AS revenue
    FROM `elmaddin-bq-demo`.`raw`.`events`
    WHERE event_name = 'purchase'
),

cohorts AS (
    SELECT
        DATE_TRUNC(signup_date, DAY) AS cohort_date,
        COUNT(DISTINCT user_id) AS cohort_size
    FROM `elmaddin-bq-demo`.`raw`.`events`
    WHERE signup_date IS NOT NULL
    GROUP BY 1
),

ltv_calc AS (
    SELECT
        DATE_TRUNC(u.signup_date, DAY) AS cohort_date,
        u.day_offset,
        COUNT(DISTINCT u.user_id) AS active_users,
        SUM(u.revenue) AS revenue
    FROM user_orders u
    GROUP BY 1, 2
)

SELECT
    l.cohort_date,
    l.day_offset,
    l.active_users,
    SAFE_DIVIDE(SUM(l.revenue), NULLIF(c.cohort_size, 0)) AS avg_ltv_per_user,
    l.revenue
FROM ltv_calc l
LEFT JOIN cohorts c
ON l.cohort_date = c.cohort_date
ORDER BY l.cohort_date, l.day_offset
    );
  
[0m13:15:52.548943 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:15:53.642493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:9e7e914d-e3cc-4eba-861b-5fe848ccadbb&page=queryresults
[0m13:15:53.976112 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:9e7e914d-e3cc-4eba-861b-5fe848ccadbb&page=queryresults
[0m13:15:53.981126 [debug] [Thread-1 (]: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: signup_date at [20:9]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:15:53.983126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eb2c2c9-f6ab-42d4-a567-7c0885609268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC327C0A00>]}
[0m13:15:53.984127 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.mart_cohort_ltv ................ [[31mERROR[0m in 1.48s]
[0m13:15:53.985608 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:15:53.986213 [debug] [Thread-7 (]: Marking all children of 'model.bq_ecom_profile.mart_cohort_ltv' to be skipped because of status 'error'.  Reason: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: signup_date at [20:9]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql.
[0m13:15:53.988223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:53.990552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:53.991057 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m13:15:53.991057 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:15:53.991608 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_cohort_ltv' was properly closed.
[0m13:15:53.991608 [info ] [MainThread]: 
[0m13:15:53.992616 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m13:15:53.992616 [debug] [MainThread]: Command end result
[0m13:15:54.016628 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:15:54.018619 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:15:54.025803 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:15:54.025803 [info ] [MainThread]: 
[0m13:15:54.026652 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:15:54.027322 [info ] [MainThread]: 
[0m13:15:54.027322 [error] [MainThread]: [31mFailure in model mart_cohort_ltv (models\mart_cohort_ltv.sql)[0m
[0m13:15:54.028341 [error] [MainThread]:   Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: signup_date at [20:9]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:15:54.028341 [info ] [MainThread]: 
[0m13:15:54.028341 [info ] [MainThread]:   compiled code at target\compiled\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:15:54.029326 [info ] [MainThread]: 
[0m13:15:54.029326 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:15:54.030326 [debug] [MainThread]: Command `dbt run` failed at 13:15:54.030326 after 7.56 seconds
[0m13:15:54.030326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC14096320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC30DB4C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC327099C0>]}
[0m13:15:54.031343 [debug] [MainThread]: Flushing usage events
[0m13:15:54.745173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:55.412509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203C2B6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203D63FC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203D63FEE0>]}


============================== 13:18:55.416629 | a9933906-7b78-4138-98f8-00d9693fccff ==============================
[0m13:18:55.416629 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:18:55.417666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --select mart_cohort_ltv --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True'}
[0m13:18:58.867763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9933906-7b78-4138-98f8-00d9693fccff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205A0DBC70>]}
[0m13:18:58.944083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9933906-7b78-4138-98f8-00d9693fccff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203C60AB90>]}
[0m13:18:58.944083 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:18:59.421132 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:18:59.605715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:59.606712 [debug] [MainThread]: Partial parsing: updated file: bq_ecom_profile://models\mart_cohort_ltv.sql
[0m13:18:59.834949 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bq_ecom_profile.mart_cohort_ltv' (models\mart_cohort_ltv.sql) depends on a source named 'raw.raw' which was not found
[0m13:18:59.836706 [debug] [MainThread]: Command `dbt run` failed at 13:18:59.836706 after 4.55 seconds
[0m13:18:59.836706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203C2B6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205A7381F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205A772800>]}
[0m13:18:59.837661 [debug] [MainThread]: Flushing usage events
[0m13:19:00.550007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:59.161419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293105823B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293118DFC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293118DFF70>]}


============================== 13:20:59.165418 | 1ba0c356-2303-47f6-b408-e52fac008886 ==============================
[0m13:20:59.165418 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:20:59.166417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt run --select mart_cohort_ltv --profiles-dir .', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True'}
[0m13:21:02.489701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ba0c356-2303-47f6-b408-e52fac008886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930D94D7E0>]}
[0m13:21:02.579892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ba0c356-2303-47f6-b408-e52fac008886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930E5512A0>]}
[0m13:21:02.581249 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:21:03.169331 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:21:03.391533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:21:03.392531 [debug] [MainThread]: Partial parsing: updated file: bq_ecom_profile://models\mart_cohort_ltv.sql
[0m13:21:03.771589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ba0c356-2303-47f6-b408-e52fac008886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932EC51720>]}
[0m13:21:03.893611 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:21:03.896589 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:21:03.920599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ba0c356-2303-47f6-b408-e52fac008886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932E99B0A0>]}
[0m13:21:03.921601 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m13:21:03.922594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba0c356-2303-47f6-b408-e52fac008886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930F3E5870>]}
[0m13:21:03.924597 [info ] [MainThread]: 
[0m13:21:03.925596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:03.925596 [info ] [MainThread]: 
[0m13:21:03.926596 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:03.928597 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m13:21:03.928597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:04.677995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:21:04.678998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:05.372597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba0c356-2303-47f6-b408-e52fac008886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932E3CB8B0>]}
[0m13:21:05.373600 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:05.380075 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:21:05.380075 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.mart_cohort_ltv ......................... [RUN]
[0m13:21:05.381074 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m13:21:05.381074 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m13:21:05.389711 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:21:05.391693 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m13:21:05.426880 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:21:05.427885 [debug] [Thread-1 (]: On model.bq_ecom_profile.mart_cohort_ltv: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_cohort_ltv"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
      
    
    

    
    OPTIONS()
    as (
      

WITH user_orders AS (
    SELECT
        user_id,
        DATE_TRUNC(order_ts, DAY) AS order_date,
        order_ts,
        total_amount AS revenue
    FROM `elmaddin-bq-demo`.`raw`.`orders`
),

cohorts AS (
    SELECT
        user_id,
        MIN(DATE_TRUNC(order_ts, DAY)) AS cohort_date
    FROM `elmaddin-bq-demo`.`raw`.`orders`
    GROUP BY 1
),

ltv_calc AS (
    SELECT
        c.cohort_date,
        DATE_DIFF(DATE_TRUNC(u.order_ts, DAY), c.cohort_date, DAY) AS day_offset,
        COUNT(DISTINCT u.user_id) AS active_users,
        SUM(u.revenue) AS revenue
    FROM user_orders u
    JOIN cohorts c
      ON u.user_id = c.user_id
    GROUP BY 1, 2
)

SELECT
    l.cohort_date,
    l.day_offset,
    l.active_users,
    SAFE_DIVIDE(l.revenue, NULLIF(COUNT(DISTINCT u.user_id),0)) AS avg_ltv_per_user,
    l.revenue
FROM ltv_calc l
ORDER BY l.cohort_date, l.day_offset
    );
  
[0m13:21:05.428786 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:06.448138 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:9eb53b83-bc2f-48e5-9413-ad634c85b5ad&page=queryresults
[0m13:21:06.766097 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:9eb53b83-bc2f-48e5-9413-ad634c85b5ad&page=queryresults
[0m13:21:06.770011 [debug] [Thread-1 (]: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: u at [49:50]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:21:06.773015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba0c356-2303-47f6-b408-e52fac008886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932EC246A0>]}
[0m13:21:06.774018 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.mart_cohort_ltv ................ [[31mERROR[0m in 1.39s]
[0m13:21:06.775018 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:21:06.775018 [debug] [Thread-7 (]: Marking all children of 'model.bq_ecom_profile.mart_cohort_ltv' to be skipped because of status 'error'.  Reason: Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: u at [49:50]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql.
[0m13:21:06.777016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:06.778014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:06.779034 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m13:21:06.779034 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:21:06.779034 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_cohort_ltv' was properly closed.
[0m13:21:06.780043 [info ] [MainThread]: 
[0m13:21:06.780043 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m13:21:06.781017 [debug] [MainThread]: Command end result
[0m13:21:06.804643 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:21:06.807640 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:21:06.813765 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:21:06.814643 [info ] [MainThread]: 
[0m13:21:06.815681 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:21:06.815681 [info ] [MainThread]: 
[0m13:21:06.816639 [error] [MainThread]: [31mFailure in model mart_cohort_ltv (models\mart_cohort_ltv.sql)[0m
[0m13:21:06.816639 [error] [MainThread]:   Database Error in model mart_cohort_ltv (models\mart_cohort_ltv.sql)
  Unrecognized name: u at [49:50]
  compiled code at target\run\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:21:06.816639 [info ] [MainThread]: 
[0m13:21:06.817639 [info ] [MainThread]:   compiled code at target\compiled\bq_ecom_profile\models\mart_cohort_ltv.sql
[0m13:21:06.817639 [info ] [MainThread]: 
[0m13:21:06.818638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:21:06.818638 [debug] [MainThread]: Command `dbt run` failed at 13:21:06.818638 after 7.74 seconds
[0m13:21:06.819644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293105823B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930E5512A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930F3C2AA0>]}
[0m13:21:06.819644 [debug] [MainThread]: Flushing usage events
[0m13:21:07.573378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:09.933147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D5DF23B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D714FC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D714FF70>]}


============================== 13:22:09.937273 | 2d93dd7d-e5ce-4328-b646-edd11dac2089 ==============================
[0m13:22:09.937273 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:22:09.938266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run --select mart_cohort_ltv --profiles-dir .', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True'}
[0m13:22:13.404173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d93dd7d-e5ce-4328-b646-edd11dac2089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F2AE77F0>]}
[0m13:22:13.477949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d93dd7d-e5ce-4328-b646-edd11dac2089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D6F687F0>]}
[0m13:22:13.478950 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:22:13.964809 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:22:14.151306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:22:14.152330 [debug] [MainThread]: Partial parsing: updated file: bq_ecom_profile://models\mart_cohort_ltv.sql
[0m13:22:14.468697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d93dd7d-e5ce-4328-b646-edd11dac2089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F44B1A50>]}
[0m13:22:14.572833 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:22:14.574833 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:22:14.598649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d93dd7d-e5ce-4328-b646-edd11dac2089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F41F85E0>]}
[0m13:22:14.599669 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m13:22:14.599669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d93dd7d-e5ce-4328-b646-edd11dac2089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D4C55870>]}
[0m13:22:14.601654 [info ] [MainThread]: 
[0m13:22:14.601654 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:14.602652 [info ] [MainThread]: 
[0m13:22:14.602652 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:22:14.604649 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m13:22:14.604649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:15.343652 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:22:15.343652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:16.053566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d93dd7d-e5ce-4328-b646-edd11dac2089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F3C96740>]}
[0m13:22:16.053566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:16.060391 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:22:16.061399 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.mart_cohort_ltv ......................... [RUN]
[0m13:22:16.061399 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m13:22:16.062399 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m13:22:16.069418 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:22:16.070412 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m13:22:16.106619 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:22:16.107618 [debug] [Thread-1 (]: On model.bq_ecom_profile.mart_cohort_ltv: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_cohort_ltv"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
      
    
    

    
    OPTIONS()
    as (
      

WITH user_orders AS (
    SELECT
        user_id,
        DATE_TRUNC(order_ts, DAY) AS order_date,
        order_ts,
        total_amount AS revenue
    FROM `elmaddin-bq-demo`.`raw`.`orders`
),

cohorts AS (
    SELECT
        user_id,
        MIN(DATE_TRUNC(order_ts, DAY)) AS cohort_date
    FROM `elmaddin-bq-demo`.`raw`.`orders`
    GROUP BY 1
),

ltv_calc AS (
    SELECT
        c.cohort_date,
        DATE_DIFF(DATE_TRUNC(u.order_ts, DAY), c.cohort_date, DAY) AS day_offset,
        COUNT(DISTINCT u.user_id) AS active_users,
        SUM(u.revenue) AS revenue
    FROM user_orders u
    JOIN cohorts c
      ON u.user_id = c.user_id
    GROUP BY 1, 2
)

SELECT
    l.cohort_date,
    l.day_offset,
    l.active_users,
    SAFE_DIVIDE(l.revenue, NULLIF(l.active_users, 0)) AS avg_ltv_per_user,
    l.revenue
FROM ltv_calc l
ORDER BY l.cohort_date, l.day_offset
    );
  
[0m13:22:16.108587 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:22:17.196154 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:e3511451-24fd-40a4-aca3-a1ceb96908c1&page=queryresults
[0m13:22:19.958637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d93dd7d-e5ce-4328-b646-edd11dac2089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EDCC68F0>]}
[0m13:22:19.959702 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.mart_cohort_ltv .................... [[32mCREATE TABLE (3.0 rows, 60.0 Bytes processed)[0m in 3.90s]
[0m13:22:19.960623 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:22:19.961617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:19.963699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:19.963699 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m13:22:19.964702 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:22:19.964702 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_cohort_ltv' was properly closed.
[0m13:22:19.964702 [info ] [MainThread]: 
[0m13:22:19.965623 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m13:22:19.966625 [debug] [MainThread]: Command end result
[0m13:22:19.989318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:22:19.993245 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:22:19.999873 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:22:19.999873 [info ] [MainThread]: 
[0m13:22:20.000881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:20.000881 [info ] [MainThread]: 
[0m13:22:20.001883 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:22:20.002902 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:20.002902 after 10.15 seconds
[0m13:22:20.002902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D5DF23B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F2AE77F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D6F687F0>]}
[0m13:22:20.003896 [debug] [MainThread]: Flushing usage events
[0m13:22:20.706677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:36.982899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233B29A6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233B3D2FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233B3D2FF70>]}


============================== 13:25:36.988055 | f5024c2f-8a62-4d64-b3c5-f589aed76d17 ==============================
[0m13:25:36.988055 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:25:36.989054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run -m mart_cohort_ltv', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m13:25:36.989054 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:25:36.990052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f5024c2f-8a62-4d64-b3c5-f589aed76d17', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233B3D2FEE0>]}
[0m13:25:40.391615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5024c2f-8a62-4d64-b3c5-f589aed76d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233AFD8E650>]}
[0m13:25:40.466442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5024c2f-8a62-4d64-b3c5-f589aed76d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233B3B48880>]}
[0m13:25:40.467452 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:25:40.975609 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:25:41.162994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:41.162994 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:41.225834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5024c2f-8a62-4d64-b3c5-f589aed76d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D0E70130>]}
[0m13:25:41.332496 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:25:41.335688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:25:41.358693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5024c2f-8a62-4d64-b3c5-f589aed76d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D0DE1420>]}
[0m13:25:41.359694 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m13:25:41.360693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5024c2f-8a62-4d64-b3c5-f589aed76d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D0E12A10>]}
[0m13:25:41.361722 [info ] [MainThread]: 
[0m13:25:41.361722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:41.362694 [info ] [MainThread]: 
[0m13:25:41.362694 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:25:41.364693 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m13:25:41.364693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:42.094068 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:25:42.095051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:42.797547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5024c2f-8a62-4d64-b3c5-f589aed76d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D084AF80>]}
[0m13:25:42.798606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:42.805393 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:25:42.805393 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.mart_cohort_ltv ......................... [RUN]
[0m13:25:42.806392 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m13:25:42.806392 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m13:25:42.816408 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:25:42.817391 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m13:25:42.830506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:43.709572 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:25:43.710580 [debug] [Thread-1 (]: On model.bq_ecom_profile.mart_cohort_ltv: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_cohort_ltv"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
      
    
    

    
    OPTIONS()
    as (
      

WITH user_orders AS (
    SELECT
        user_id,
        DATE_TRUNC(order_ts, DAY) AS order_date,
        order_ts,
        total_amount AS revenue
    FROM `elmaddin-bq-demo`.`raw`.`orders`
),

cohorts AS (
    SELECT
        user_id,
        MIN(DATE_TRUNC(order_ts, DAY)) AS cohort_date
    FROM `elmaddin-bq-demo`.`raw`.`orders`
    GROUP BY 1
),

ltv_calc AS (
    SELECT
        c.cohort_date,
        DATE_DIFF(DATE_TRUNC(u.order_ts, DAY), c.cohort_date, DAY) AS day_offset,
        COUNT(DISTINCT u.user_id) AS active_users,
        SUM(u.revenue) AS revenue
    FROM user_orders u
    JOIN cohorts c
      ON u.user_id = c.user_id
    GROUP BY 1, 2
)

SELECT
    l.cohort_date,
    l.day_offset,
    l.active_users,
    SAFE_DIVIDE(l.revenue, NULLIF(l.active_users, 0)) AS avg_ltv_per_user,
    l.revenue
FROM ltv_calc l
ORDER BY l.cohort_date, l.day_offset
    );
  
[0m13:25:44.476712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:fcca9313-41fa-4a41-b6a9-ad440f3c1578&page=queryresults
[0m13:25:47.255674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5024c2f-8a62-4d64-b3c5-f589aed76d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233CA8AA8F0>]}
[0m13:25:47.256722 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.mart_cohort_ltv .................... [[32mCREATE TABLE (3.0 rows, 60.0 Bytes processed)[0m in 4.45s]
[0m13:25:47.256722 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:25:47.258727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:47.259727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:47.260743 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m13:25:47.260743 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:25:47.260743 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_cohort_ltv' was properly closed.
[0m13:25:47.261745 [info ] [MainThread]: 
[0m13:25:47.261745 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m13:25:47.262729 [debug] [MainThread]: Command end result
[0m13:25:47.286363 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:25:47.288369 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:25:47.294451 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:25:47.295370 [info ] [MainThread]: 
[0m13:25:47.295370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:47.296477 [info ] [MainThread]: 
[0m13:25:47.297385 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:25:47.297385 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:25:47.298394 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:47.298394 after 10.40 seconds
[0m13:25:47.299385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233B29A6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D0E5F700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233B3B48880>]}
[0m13:25:47.299385 [debug] [MainThread]: Flushing usage events
[0m13:25:48.045526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:09.363481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5D5D56380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5D70DFC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5D70DFE20>]}


============================== 13:26:09.367481 | cfc1f3f5-a8a2-45ae-a64b-6b63acd995ee ==============================
[0m13:26:09.367481 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:26:09.368481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'None', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt test --models mart_cohort_ltv', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m13:26:09.368481 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:26:09.369479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cfc1f3f5-a8a2-45ae-a64b-6b63acd995ee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5D70DFA60>]}
[0m13:26:12.672029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfc1f3f5-a8a2-45ae-a64b-6b63acd995ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5D7080E20>]}
[0m13:26:12.747488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfc1f3f5-a8a2-45ae-a64b-6b63acd995ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5D3B36DD0>]}
[0m13:26:12.748489 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:26:13.258260 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:26:13.447242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:13.447242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:13.510612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfc1f3f5-a8a2-45ae-a64b-6b63acd995ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F421C340>]}
[0m13:26:13.617427 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:26:13.620339 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:26:13.655067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfc1f3f5-a8a2-45ae-a64b-6b63acd995ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F4241690>]}
[0m13:26:13.655067 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m13:26:13.656066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfc1f3f5-a8a2-45ae-a64b-6b63acd995ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F421F370>]}
[0m13:26:13.657090 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:26:13.659068 [debug] [MainThread]: Command end result
[0m13:26:13.682098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:26:13.685096 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:26:13.688179 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:26:13.689163 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:26:13.690163 [debug] [MainThread]: Command `dbt test` succeeded at 13:26:13.690163 after 4.41 seconds
[0m13:26:13.690163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5D5D56380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5D60D0B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F4249030>]}
[0m13:26:13.691179 [debug] [MainThread]: Flushing usage events
[0m13:26:14.698637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:13.816242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2C316380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2D68DEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2D68DCC0>]}


============================== 13:29:13.820284 | ea8a79f4-ac52-4061-a76c-eb3be2988a68 ==============================
[0m13:29:13.820284 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:29:13.820284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt ls --select mart_cohort_ltv', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m13:29:17.332554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea8a79f4-ac52-4061-a76c-eb3be2988a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C48F8E500>]}
[0m13:29:17.409323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea8a79f4-ac52-4061-a76c-eb3be2988a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C441F97B0>]}
[0m13:29:17.410404 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:29:17.924521 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:29:18.116657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:18.116657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:18.181341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea8a79f4-ac52-4061-a76c-eb3be2988a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4A7DFE50>]}
[0m13:29:18.296073 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:29:18.298989 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:29:18.323501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea8a79f4-ac52-4061-a76c-eb3be2988a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4A77ED40>]}
[0m13:29:18.324503 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m13:29:18.325504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea8a79f4-ac52-4061-a76c-eb3be2988a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4A77E410>]}
[0m13:29:18.326523 [info ] [MainThread]: bq_ecom_profile.mart_cohort_ltv
[0m13:29:18.327501 [debug] [MainThread]: Command `dbt ls` succeeded at 13:29:18.327501 after 4.60 seconds
[0m13:29:18.327501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2C316380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C441F97B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2ACDE5F0>]}
[0m13:29:18.328522 [debug] [MainThread]: Flushing usage events
[0m13:29:19.083465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:50.678303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EA0C6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EB45FC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EB45FEE0>]}


============================== 13:29:50.682302 | f179b345-cf9e-4703-b5ce-deaf5d570e04 ==============================
[0m13:29:50.682302 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:29:50.683302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run --select mart_cohort_ltv', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m13:29:54.174526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f179b345-cf9e-4703-b5ce-deaf5d570e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027087F49330>]}
[0m13:29:54.251364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f179b345-cf9e-4703-b5ce-deaf5d570e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027087DF3E80>]}
[0m13:29:54.252440 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:29:54.779474 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:29:54.976496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:54.977496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:55.042013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f179b345-cf9e-4703-b5ce-deaf5d570e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270885B3EB0>]}
[0m13:29:55.149035 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:29:55.152035 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:29:55.176052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f179b345-cf9e-4703-b5ce-deaf5d570e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027088519C60>]}
[0m13:29:55.176052 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m13:29:55.177054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f179b345-cf9e-4703-b5ce-deaf5d570e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002708854CFD0>]}
[0m13:29:55.178053 [info ] [MainThread]: 
[0m13:29:55.178940 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:29:55.178940 [info ] [MainThread]: 
[0m13:29:55.179951 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:29:55.180950 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m13:29:55.180950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:55.886250 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:29:55.886250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:56.618560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f179b345-cf9e-4703-b5ce-deaf5d570e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E8FA1660>]}
[0m13:29:56.619559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:56.624564 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:29:56.624564 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.mart_cohort_ltv ......................... [RUN]
[0m13:29:56.625565 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m13:29:56.625565 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m13:29:56.636689 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:29:56.637672 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m13:29:56.651776 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:29:57.408446 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:29:57.409445 [debug] [Thread-1 (]: On model.bq_ecom_profile.mart_cohort_ltv: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_cohort_ltv"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
      
    
    

    
    OPTIONS()
    as (
      

WITH user_orders AS (
    SELECT
        user_id,
        DATE_TRUNC(order_ts, DAY) AS order_date,
        order_ts,
        total_amount AS revenue
    FROM `elmaddin-bq-demo`.`raw`.`orders`
),

cohorts AS (
    SELECT
        user_id,
        MIN(DATE_TRUNC(order_ts, DAY)) AS cohort_date
    FROM `elmaddin-bq-demo`.`raw`.`orders`
    GROUP BY 1
),

ltv_calc AS (
    SELECT
        c.cohort_date,
        DATE_DIFF(DATE_TRUNC(u.order_ts, DAY), c.cohort_date, DAY) AS day_offset,
        COUNT(DISTINCT u.user_id) AS active_users,
        SUM(u.revenue) AS revenue
    FROM user_orders u
    JOIN cohorts c
      ON u.user_id = c.user_id
    GROUP BY 1, 2
)

SELECT
    l.cohort_date,
    l.day_offset,
    l.active_users,
    SAFE_DIVIDE(l.revenue, NULLIF(l.active_users, 0)) AS avg_ltv_per_user,
    l.revenue
FROM ltv_calc l
ORDER BY l.cohort_date, l.day_offset
    );
  
[0m13:29:58.090301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:544d6940-7b44-48e6-b05b-31c2f74ee831&page=queryresults
[0m13:30:00.526815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f179b345-cf9e-4703-b5ce-deaf5d570e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027081FE68F0>]}
[0m13:30:00.527928 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.mart_cohort_ltv .................... [[32mCREATE TABLE (3.0 rows, 60.0 Bytes processed)[0m in 3.90s]
[0m13:30:00.528862 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:30:00.529821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:00.531822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:00.531822 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m13:30:00.532859 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:30:00.532859 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_cohort_ltv' was properly closed.
[0m13:30:00.533824 [info ] [MainThread]: 
[0m13:30:00.533824 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m13:30:00.534822 [debug] [MainThread]: Command end result
[0m13:30:00.558880 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:30:00.560880 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:30:00.567911 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:30:00.568887 [info ] [MainThread]: 
[0m13:30:00.569879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:00.569879 [info ] [MainThread]: 
[0m13:30:00.570885 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:30:00.571912 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:00.571912 after 9.99 seconds
[0m13:30:00.571912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EA0C6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EA40CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002708858F5B0>]}
[0m13:30:00.572900 [debug] [MainThread]: Flushing usage events
[0m13:30:01.220507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:30:07.092327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211294623B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112A73D330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112A73E770>]}


============================== 13:30:07.096320 | 9df56df8-429e-4cad-86c3-8c9d9f44f8d1 ==============================
[0m13:30:07.096320 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:30:07.096320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'None', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt test --select mart_cohort_ltv', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m13:30:10.630340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9df56df8-429e-4cad-86c3-8c9d9f44f8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021147295270>]}
[0m13:30:10.710177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9df56df8-429e-4cad-86c3-8c9d9f44f8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112A502E00>]}
[0m13:30:10.711178 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:30:11.309241 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:30:11.501559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:11.502560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:11.568476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9df56df8-429e-4cad-86c3-8c9d9f44f8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021147903E20>]}
[0m13:30:11.686675 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:30:11.688731 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:30:11.724796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9df56df8-429e-4cad-86c3-8c9d9f44f8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211479204C0>]}
[0m13:30:11.724796 [info ] [MainThread]: Found 5 models, 2 seeds, 2 data tests, 3 sources, 508 macros
[0m13:30:11.725824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df56df8-429e-4cad-86c3-8c9d9f44f8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211479218A0>]}
[0m13:30:11.726824 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:30:11.728822 [debug] [MainThread]: Command end result
[0m13:30:11.753491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:30:11.756464 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:30:11.761220 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:30:11.763252 [debug] [MainThread]: Command `dbt test` succeeded at 13:30:11.762225 after 4.76 seconds
[0m13:30:11.763252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211294623B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021147248400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114724B3A0>]}
[0m13:30:11.764284 [debug] [MainThread]: Flushing usage events
[0m13:30:12.416665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:21.369778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA7E116350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA7F49FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA7F49FDF0>]}


============================== 13:32:21.373779 | 6102819e-c32b-420d-b765-5886d676fdef ==============================
[0m13:32:21.373779 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:32:21.374778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt docs generate', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m13:32:24.870763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6102819e-c32b-420d-b765-5886d676fdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA7B4EE440>]}
[0m13:32:24.948256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6102819e-c32b-420d-b765-5886d676fdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA16215450>]}
[0m13:32:24.949265 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:32:25.458264 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:32:25.665573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m13:32:25.666574 [debug] [MainThread]: Partial parsing: added file: bq_ecom_profile://tests\no_negative_revenue.sql
[0m13:32:25.667574 [debug] [MainThread]: Partial parsing: added file: bq_ecom_profile://models\mart_cohort_ltv.yml
[0m13:32:25.961119 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\mart_cohort_ltv.yml:
  	test arguments must be a dict, got <class 'list'> (value ['cohort_date', 'day_offset'])
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m13:32:25.964033 [debug] [MainThread]: Command `dbt docs generate` failed at 13:32:25.964033 after 4.68 seconds
[0m13:32:25.964033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA7E116350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1CABB0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1CABBF10>]}
[0m13:32:25.964033 [debug] [MainThread]: Flushing usage events
[0m13:32:26.694345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:18.533310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CE826320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CFBAFC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CFBAFDF0>]}


============================== 13:39:18.538422 | ce52fda9-c92e-45e5-8be1-eff9a53677d9 ==============================
[0m13:39:18.538422 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:39:18.539393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'None', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m13:39:23.556362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce52fda9-c92e-45e5-8be1-eff9a53677d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0EC6852D0>]}
[0m13:39:23.631663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce52fda9-c92e-45e5-8be1-eff9a53677d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CC649900>]}
[0m13:39:23.632664 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:39:24.257531 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:39:25.074179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m13:39:25.075181 [debug] [MainThread]: Partial parsing: added file: bq_ecom_profile://tests\no_negative_revenue.sql
[0m13:39:25.075181 [debug] [MainThread]: Partial parsing: added file: bq_ecom_profile://models\mart_cohort_ltv.yml
[0m13:39:25.360062 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\mart_cohort_ltv.yml:
  	test arguments must be a dict, got <class 'str'> (value combination_of_c)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m13:39:25.360971 [debug] [MainThread]: Command `dbt docs generate` failed at 13:39:25.360971 after 6.92 seconds
[0m13:39:25.362052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CE826320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0ECD43550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0ECD42890>]}
[0m13:39:25.362052 [debug] [MainThread]: Flushing usage events
[0m13:39:26.087682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:11.279676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161E79362C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161E8CBFBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161E8CBFDC0>]}


============================== 13:41:11.284709 | a0bf90b4-739c-40be-9f60-1119e228e785 ==============================
[0m13:41:11.284709 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:41:11.285233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'None', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None'}
[0m13:41:14.825345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0bf90b4-739c-40be-9f60-1119e228e785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161E8C63100>]}
[0m13:41:14.915262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0bf90b4-739c-40be-9f60-1119e228e785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161FF819570>]}
[0m13:41:14.916233 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:41:15.487380 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:41:15.683904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m13:41:15.684904 [debug] [MainThread]: Partial parsing: added file: bq_ecom_profile://tests\no_negative_revenue.sql
[0m13:41:15.685412 [debug] [MainThread]: Partial parsing: added file: bq_ecom_profile://models\mart_cohort_ltv.yml
[0m13:41:16.088979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0bf90b4-739c-40be-9f60-1119e228e785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016186254F40>]}
[0m13:41:16.116472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0bf90b4-739c-40be-9f60-1119e228e785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161862561A0>]}
[0m13:41:16.117471 [info ] [MainThread]: Found 5 models, 2 seeds, 8 data tests, 3 sources, 508 macros
[0m13:41:16.117471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0bf90b4-739c-40be-9f60-1119e228e785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016186256410>]}
[0m13:41:16.120478 [info ] [MainThread]: 
[0m13:41:16.120478 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:41:16.121234 [info ] [MainThread]: 
[0m13:41:16.121234 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:41:16.126260 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:41:16.127246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:16.858442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0bf90b4-739c-40be-9f60-1119e228e785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161846B89D0>]}
[0m13:41:16.858442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:16.865442 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:41:16.866461 [debug] [Thread-2 (]: Began running node model.bq_ecom_profile.mart_cohorts
[0m13:41:16.866461 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m13:41:16.867441 [debug] [Thread-3 (]: Began running node model.bq_ecom_profile.stg_events
[0m13:41:16.867441 [debug] [Thread-4 (]: Began running node model.bq_ecom_profile.stg_orders
[0m13:41:16.868443 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohorts'
[0m13:41:16.868443 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m13:41:16.869441 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.stg_events'
[0m13:41:16.869441 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.stg_orders'
[0m13:41:16.869441 [debug] [Thread-2 (]: Began compiling node model.bq_ecom_profile.mart_cohorts
[0m13:41:16.878530 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:41:16.878530 [debug] [Thread-3 (]: Began compiling node model.bq_ecom_profile.stg_events
[0m13:41:16.879485 [debug] [Thread-4 (]: Began compiling node model.bq_ecom_profile.stg_orders
[0m13:41:16.881450 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohorts"
[0m13:41:16.885132 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_ecom_profile.stg_events"
[0m13:41:16.887755 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_ecom_profile.stg_orders"
[0m13:41:16.888829 [debug] [Thread-2 (]: Began executing node model.bq_ecom_profile.mart_cohorts
[0m13:41:16.889342 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:41:16.890357 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m13:41:16.890357 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:41:16.892350 [debug] [Thread-2 (]: Finished running node model.bq_ecom_profile.mart_cohorts
[0m13:41:16.893424 [debug] [Thread-2 (]: Began running node seed.bq_ecom_profile.sample_orders
[0m13:41:16.893424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.mart_cohorts, now seed.bq_ecom_profile.sample_orders)
[0m13:41:16.894387 [debug] [Thread-2 (]: Began compiling node seed.bq_ecom_profile.sample_orders
[0m13:41:16.896363 [debug] [Thread-2 (]: Began executing node seed.bq_ecom_profile.sample_orders
[0m13:41:16.897349 [debug] [Thread-3 (]: Began executing node model.bq_ecom_profile.stg_events
[0m13:41:16.898363 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:41:16.899364 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:16.899364 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:41:16.900351 [debug] [Thread-4 (]: Began executing node model.bq_ecom_profile.stg_orders
[0m13:41:16.901061 [debug] [Thread-1 (]: Began running node seed.bq_ecom_profile.sample_users
[0m13:41:16.901589 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:41:16.903611 [debug] [Thread-2 (]: Finished running node seed.bq_ecom_profile.sample_orders
[0m13:41:16.904595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.mart_cohort_ltv, now seed.bq_ecom_profile.sample_users)
[0m13:41:16.905595 [debug] [Thread-3 (]: Finished running node model.bq_ecom_profile.stg_events
[0m13:41:16.906597 [debug] [Thread-2 (]: Began running node test.bq_ecom_profile.no_negative_revenue
[0m13:41:16.907620 [debug] [Thread-4 (]: Finished running node model.bq_ecom_profile.stg_orders
[0m13:41:16.908612 [debug] [Thread-1 (]: Began compiling node seed.bq_ecom_profile.sample_users
[0m13:41:16.908612 [debug] [Thread-3 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:41:16.909596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.bq_ecom_profile.sample_orders, now test.bq_ecom_profile.no_negative_revenue)
[0m13:41:16.909596 [debug] [Thread-4 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:41:16.912596 [debug] [Thread-1 (]: Began executing node seed.bq_ecom_profile.sample_users
[0m13:41:16.912596 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.stg_events, now test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b)
[0m13:41:16.913610 [debug] [Thread-2 (]: Began compiling node test.bq_ecom_profile.no_negative_revenue
[0m13:41:16.913610 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.stg_orders, now test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d)
[0m13:41:16.914634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:16.914634 [debug] [Thread-3 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:41:16.918614 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_ecom_profile.no_negative_revenue"
[0m13:41:16.918614 [debug] [Thread-4 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:41:16.925618 [debug] [Thread-1 (]: Finished running node seed.bq_ecom_profile.sample_users
[0m13:41:16.936647 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b"
[0m13:41:16.937647 [debug] [Thread-1 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:41:16.938732 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d"
[0m13:41:16.939647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.bq_ecom_profile.sample_users, now test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce)
[0m13:41:16.940656 [debug] [Thread-1 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:41:16.944663 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce"
[0m13:41:16.945646 [debug] [Thread-3 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:41:16.946648 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:16.947653 [debug] [Thread-1 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:41:16.948648 [debug] [Thread-2 (]: Began executing node test.bq_ecom_profile.no_negative_revenue
[0m13:41:16.948648 [debug] [Thread-4 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:41:16.949646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:16.949646 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:16.951647 [debug] [Thread-3 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:41:16.952652 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:16.952652 [debug] [Thread-3 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:41:16.954672 [debug] [Thread-2 (]: Finished running node test.bq_ecom_profile.no_negative_revenue
[0m13:41:16.956650 [debug] [Thread-1 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:41:16.958663 [debug] [Thread-4 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:41:16.958663 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b, now test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac)
[0m13:41:16.959355 [debug] [Thread-2 (]: Began running node test.bq_ecom_profile.unique_mart_cohort_ltv__CAST_cohort_date_AS_STRING_CAST_day_offset_AS_STRING_.c3dfb6fc5d
[0m13:41:16.959355 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_funnels
[0m13:41:16.960393 [debug] [Thread-4 (]: Began running node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m13:41:16.960393 [debug] [Thread-3 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:41:16.961364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.no_negative_revenue, now test.bq_ecom_profile.unique_mart_cohort_ltv__CAST_cohort_date_AS_STRING_CAST_day_offset_AS_STRING_.c3dfb6fc5d)
[0m13:41:16.961364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce, now model.bq_ecom_profile.mart_funnels)
[0m13:41:16.961364 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d, now test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012)
[0m13:41:16.966366 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac"
[0m13:41:16.966366 [debug] [Thread-2 (]: Began compiling node test.bq_ecom_profile.unique_mart_cohort_ltv__CAST_cohort_date_AS_STRING_CAST_day_offset_AS_STRING_.c3dfb6fc5d
[0m13:41:16.967387 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_funnels
[0m13:41:16.967387 [debug] [Thread-4 (]: Began compiling node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m13:41:16.973586 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_ecom_profile.unique_mart_cohort_ltv__CAST_cohort_date_AS_STRING_CAST_day_offset_AS_STRING_.c3dfb6fc5d"
[0m13:41:16.977560 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_funnels"
[0m13:41:16.982520 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012"
[0m13:41:16.983525 [debug] [Thread-3 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:41:16.983525 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:16.986581 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_funnels
[0m13:41:16.986581 [debug] [Thread-2 (]: Began executing node test.bq_ecom_profile.unique_mart_cohort_ltv__CAST_cohort_date_AS_STRING_CAST_day_offset_AS_STRING_.c3dfb6fc5d
[0m13:41:16.986581 [debug] [Thread-4 (]: Began executing node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m13:41:16.987581 [debug] [Thread-3 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:41:16.988595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:16.988595 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:16.989579 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:16.989579 [debug] [Thread-3 (]: Began running node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m13:41:16.991579 [debug] [Thread-2 (]: Finished running node test.bq_ecom_profile.unique_mart_cohort_ltv__CAST_cohort_date_AS_STRING_CAST_day_offset_AS_STRING_.c3dfb6fc5d
[0m13:41:16.993584 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_funnels
[0m13:41:16.993584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac, now test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438)
[0m13:41:16.995595 [debug] [Thread-4 (]: Finished running node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m13:41:16.995595 [debug] [Thread-3 (]: Began compiling node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m13:41:17.000597 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438"
[0m13:41:17.002266 [debug] [Thread-3 (]: Began executing node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m13:41:17.002266 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:17.004265 [debug] [Thread-3 (]: Finished running node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m13:41:17.005266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:17.006262 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:41:17.006262 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_funnels' was properly closed.
[0m13:41:17.006262 [debug] [MainThread]: Connection 'test.bq_ecom_profile.unique_mart_cohort_ltv__CAST_cohort_date_AS_STRING_CAST_day_offset_AS_STRING_.c3dfb6fc5d' was properly closed.
[0m13:41:17.007279 [debug] [MainThread]: Connection 'test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438' was properly closed.
[0m13:41:17.007279 [debug] [MainThread]: Connection 'test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012' was properly closed.
[0m13:41:17.009278 [debug] [MainThread]: Command end result
[0m13:41:17.147552 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:41:17.152552 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:41:17.159551 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:41:17.450336 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:41:17.450336 [info ] [MainThread]: Building catalog
[0m13:41:17.456338 [debug] [ThreadPool]: Acquiring new bigquery connection 'elmaddin-bq-demo.information_schema'
[0m13:41:17.462430 [debug] [ThreadPool]: Acquiring new bigquery connection 'elmaddin-bq-demo.information_schema'
[0m13:41:17.475518 [debug] [ThreadPool]: On elmaddin-bq-demo.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "connection_name": "elmaddin-bq-demo.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `elmaddin-bq-demo`.`analytics`.__TABLES__ tables
    left join `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('stg_events')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('sample_users')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('mart_funnels')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('stg_orders')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('mart_cohorts')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('mart_cohort_ltv')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('sample_orders')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:41:17.478511 [debug] [ThreadPool]: On elmaddin-bq-demo.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "connection_name": "elmaddin-bq-demo.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `elmaddin-bq-demo`.`raw`.__TABLES__ tables
    left join `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('events')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('users')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('orders')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:41:17.479517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:17.479517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:18.433614 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:d0f155a1-b2e3-43a7-bd2e-d13035cd75b0&page=queryresults
[0m13:41:18.498282 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:40427434-3c49-4ab3-922c-f417ebaa0b5d&page=queryresults
[0m13:41:20.614417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:20.628529 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\catalog.json
[0m13:41:20.654002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:41:20.656917 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:41:20.656917 [info ] [MainThread]: Catalog written to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\catalog.json
[0m13:41:20.658921 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:41:20.658921 after 9.48 seconds
[0m13:41:20.659919 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:41:20.659919 [debug] [MainThread]: Connection 'elmaddin-bq-demo.information_schema' was properly closed.
[0m13:41:20.659919 [debug] [MainThread]: Connection 'elmaddin-bq-demo.information_schema' was properly closed.
[0m13:41:20.660917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161E79362C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161E7CB0D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161862558A0>]}
[0m13:41:20.660917 [debug] [MainThread]: Flushing usage events
[0m13:41:21.402078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:14.981087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B70326350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B716A7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B716A7DF0>]}


============================== 13:43:14.984592 | dcb37cf1-4ac3-4401-8a56-4135557d22d4 ==============================
[0m13:43:14.984592 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:43:14.985126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None'}
[0m13:43:15.164674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcb37cf1-4ac3-4401-8a56-4135557d22d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B71784910>]}
[0m13:43:15.192511 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:43:15.193449 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:43:15.194462 [debug] [MainThread]: Command `dbt deps` succeeded at 13:43:15.194462 after 0.30 seconds
[0m13:43:15.195479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B70326350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B71784910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B71787BE0>]}
[0m13:43:15.195479 [debug] [MainThread]: Flushing usage events
[0m13:43:15.924153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:47.792576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB67C423B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB68F97BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB68F97E80>]}


============================== 13:43:47.795733 | 4cf2accd-20ee-4f99-b105-f8ef7a2c66ca ==============================
[0m13:43:47.795733 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:43:47.796732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m13:43:47.979500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cf2accd-20ee-4f99-b105-f8ef7a2c66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB64FED7E0>]}
[0m13:43:48.003998 [debug] [MainThread]: Set downloads directory='C:\Users\Huawei\AppData\Local\Temp\dbt-downloads-prbfyzqo'
[0m13:43:48.003998 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:43:48.401467 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:43:48.401467 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:43:48.563574 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:43:48.577416 [info ] [MainThread]: Updating lock file in file path: C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt/package-lock.yml
[0m13:43:48.591581 [debug] [MainThread]: Set downloads directory='C:\Users\Huawei\AppData\Local\Temp\dbt-downloads-dkvzb7hm'
[0m13:43:48.594596 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:43:49.391573 [info ] [MainThread]: Installed from version 0.9.6
[0m13:43:49.392569 [info ] [MainThread]: Updated version available: 1.3.1
[0m13:43:49.392569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4cf2accd-20ee-4f99-b105-f8ef7a2c66ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB67FBB280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB6921F0D0>]}
[0m13:43:49.393587 [info ] [MainThread]: 
[0m13:43:49.393587 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:43:49.395587 [debug] [MainThread]: Command `dbt deps` succeeded at 13:43:49.395587 after 1.69 seconds
[0m13:43:49.395587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB67C423B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB67F5E140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB68F1AEC0>]}
[0m13:43:49.396577 [debug] [MainThread]: Flushing usage events
[0m13:43:50.038386 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:00.372436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E6666350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E79EFBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E79EFDC0>]}


============================== 13:44:00.375435 | bab0d5af-794d-4e73-adb8-63619a42bda6 ==============================
[0m13:44:00.375435 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:44:00.376403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m13:44:03.822266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bab0d5af-794d-4e73-adb8-63619a42bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E3A3E440>]}
[0m13:44:03.894667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bab0d5af-794d-4e73-adb8-63619a42bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E44D86D0>]}
[0m13:44:03.895668 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:44:04.381891 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:44:04.529760 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:44:04.529760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bab0d5af-794d-4e73-adb8-63619a42bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E44648B0>]}
[0m13:44:06.662128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bab0d5af-794d-4e73-adb8-63619a42bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4864EC5B0>]}
[0m13:44:06.689824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bab0d5af-794d-4e73-adb8-63619a42bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D486506B60>]}
[0m13:44:06.690848 [info ] [MainThread]: Found 5 models, 8 data tests, 2 seeds, 3 sources, 705 macros
[0m13:44:06.690848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bab0d5af-794d-4e73-adb8-63619a42bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4865059C0>]}
[0m13:44:06.692834 [info ] [MainThread]: 
[0m13:44:06.693833 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:06.693833 [info ] [MainThread]: 
[0m13:44:06.694818 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:44:06.699819 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:44:06.700819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:07.492037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bab0d5af-794d-4e73-adb8-63619a42bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4833E27A0>]}
[0m13:44:07.492037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:07.498040 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:44:07.498040 [debug] [Thread-2 (]: Began running node model.bq_ecom_profile.mart_cohorts
[0m13:44:07.499042 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m13:44:07.499042 [debug] [Thread-3 (]: Began running node model.bq_ecom_profile.stg_events
[0m13:44:07.500039 [debug] [Thread-4 (]: Began running node model.bq_ecom_profile.stg_orders
[0m13:44:07.500039 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohorts'
[0m13:44:07.501063 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m13:44:07.501063 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.stg_events'
[0m13:44:07.502059 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.stg_orders'
[0m13:44:07.502059 [debug] [Thread-2 (]: Began compiling node model.bq_ecom_profile.mart_cohorts
[0m13:44:07.511043 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:44:07.511817 [debug] [Thread-3 (]: Began compiling node model.bq_ecom_profile.stg_events
[0m13:44:07.511817 [debug] [Thread-4 (]: Began compiling node model.bq_ecom_profile.stg_orders
[0m13:44:07.515900 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohorts"
[0m13:44:07.519823 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_ecom_profile.stg_events"
[0m13:44:07.522913 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_ecom_profile.stg_orders"
[0m13:44:07.522913 [debug] [Thread-2 (]: Began executing node model.bq_ecom_profile.mart_cohorts
[0m13:44:07.523902 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m13:44:07.524829 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:44:07.524829 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:44:07.525829 [debug] [Thread-3 (]: Began executing node model.bq_ecom_profile.stg_events
[0m13:44:07.526829 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:44:07.527862 [debug] [Thread-2 (]: Finished running node model.bq_ecom_profile.mart_cohorts
[0m13:44:07.528846 [debug] [Thread-4 (]: Began executing node model.bq_ecom_profile.stg_orders
[0m13:44:07.530831 [debug] [Thread-2 (]: Began running node seed.bq_ecom_profile.sample_orders
[0m13:44:07.532246 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:44:07.533259 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:44:07.533259 [debug] [Thread-3 (]: Finished running node model.bq_ecom_profile.stg_events
[0m13:44:07.534767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.mart_cohorts, now seed.bq_ecom_profile.sample_orders)
[0m13:44:07.535292 [debug] [Thread-1 (]: Began running node seed.bq_ecom_profile.sample_users
[0m13:44:07.535292 [debug] [Thread-3 (]: Began running node test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e
[0m13:44:07.536363 [debug] [Thread-2 (]: Began compiling node seed.bq_ecom_profile.sample_orders
[0m13:44:07.537815 [debug] [Thread-4 (]: Finished running node model.bq_ecom_profile.stg_orders
[0m13:44:07.537815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.mart_cohort_ltv, now seed.bq_ecom_profile.sample_users)
[0m13:44:07.538791 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.stg_events, now test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e)
[0m13:44:07.541489 [debug] [Thread-2 (]: Began executing node seed.bq_ecom_profile.sample_orders
[0m13:44:07.542461 [debug] [Thread-4 (]: Began running node test.bq_ecom_profile.no_negative_revenue
[0m13:44:07.542934 [debug] [Thread-1 (]: Began compiling node seed.bq_ecom_profile.sample_users
[0m13:44:07.542934 [debug] [Thread-3 (]: Began compiling node test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e
[0m13:44:07.543945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:44:07.543945 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_ecom_profile.stg_orders, now test.bq_ecom_profile.no_negative_revenue)
[0m13:44:07.547967 [debug] [Thread-1 (]: Began executing node seed.bq_ecom_profile.sample_users
[0m13:44:07.552961 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e"
[0m13:44:07.552961 [debug] [Thread-4 (]: Began compiling node test.bq_ecom_profile.no_negative_revenue
[0m13:44:07.553945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:07.555945 [debug] [Thread-2 (]: Finished running node seed.bq_ecom_profile.sample_orders
[0m13:44:07.558960 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_ecom_profile.no_negative_revenue"
[0m13:44:07.560947 [debug] [Thread-1 (]: Finished running node seed.bq_ecom_profile.sample_users
[0m13:44:07.561953 [debug] [Thread-3 (]: Began executing node test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e
[0m13:44:07.561953 [debug] [Thread-2 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:44:07.562947 [debug] [Thread-1 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:44:07.563953 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:44:07.564946 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.bq_ecom_profile.sample_orders, now test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b)
[0m13:44:07.564946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.bq_ecom_profile.sample_users, now test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d)
[0m13:44:07.565946 [debug] [Thread-4 (]: Began executing node test.bq_ecom_profile.no_negative_revenue
[0m13:44:07.565946 [debug] [Thread-2 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:44:07.566945 [debug] [Thread-1 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:44:07.567973 [debug] [Thread-3 (]: Finished running node test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e
[0m13:44:07.569022 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:44:07.576430 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b"
[0m13:44:07.582671 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d"
[0m13:44:07.582671 [debug] [Thread-3 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:44:07.583667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e, now test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce)
[0m13:44:07.586725 [debug] [Thread-3 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:44:07.599724 [debug] [Thread-4 (]: Finished running node test.bq_ecom_profile.no_negative_revenue
[0m13:44:07.606731 [debug] [Thread-2 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:44:07.612727 [debug] [Thread-4 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:44:07.613728 [debug] [Thread-1 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:44:07.611731 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce"
[0m13:44:07.615724 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:44:07.616727 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.no_negative_revenue, now test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac)
[0m13:44:07.617725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:07.619728 [debug] [Thread-4 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:44:07.626734 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac"
[0m13:44:07.626734 [debug] [Thread-3 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:44:07.630741 [debug] [Thread-2 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:44:07.630741 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:44:07.633735 [debug] [Thread-1 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:44:07.633735 [debug] [Thread-2 (]: Began running node model.bq_ecom_profile.mart_funnels
[0m13:44:07.634775 [debug] [Thread-1 (]: Began running node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m13:44:07.636393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b, now model.bq_ecom_profile.mart_funnels)
[0m13:44:07.638395 [debug] [Thread-3 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:44:07.638395 [debug] [Thread-4 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:44:07.639399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d, now test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012)
[0m13:44:07.639399 [debug] [Thread-2 (]: Began compiling node model.bq_ecom_profile.mart_funnels
[0m13:44:07.640395 [debug] [Thread-3 (]: Began running node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m13:44:07.641131 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:44:07.641640 [debug] [Thread-1 (]: Began compiling node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m13:44:07.647221 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_funnels"
[0m13:44:07.648224 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce, now test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438)
[0m13:44:07.655220 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012"
[0m13:44:07.657221 [debug] [Thread-4 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:44:07.658225 [debug] [Thread-3 (]: Began compiling node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m13:44:07.659263 [debug] [Thread-2 (]: Began executing node model.bq_ecom_profile.mart_funnels
[0m13:44:07.669219 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438"
[0m13:44:07.669219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:44:07.670268 [debug] [Thread-1 (]: Began executing node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m13:44:07.671226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:07.673234 [debug] [Thread-2 (]: Finished running node model.bq_ecom_profile.mart_funnels
[0m13:44:07.674317 [debug] [Thread-3 (]: Began executing node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m13:44:07.676235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:44:07.677226 [debug] [Thread-1 (]: Finished running node test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012
[0m13:44:07.680234 [debug] [Thread-3 (]: Finished running node test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438
[0m13:44:07.682226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:07.683227 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:44:07.683227 [debug] [MainThread]: Connection 'test.bq_ecom_profile.not_null_stg_events_event_id.715b3f7012' was properly closed.
[0m13:44:07.683227 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_funnels' was properly closed.
[0m13:44:07.683227 [debug] [MainThread]: Connection 'test.bq_ecom_profile.unique_stg_events_event_id.66ebb17438' was properly closed.
[0m13:44:07.683227 [debug] [MainThread]: Connection 'test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac' was properly closed.
[0m13:44:07.687276 [debug] [MainThread]: Command end result
[0m13:44:07.882063 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:44:07.885205 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:44:07.892768 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:44:07.894780 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:44:07.895769 [info ] [MainThread]: Building catalog
[0m13:44:07.902766 [debug] [ThreadPool]: Acquiring new bigquery connection 'elmaddin-bq-demo.information_schema'
[0m13:44:07.909127 [debug] [ThreadPool]: Acquiring new bigquery connection 'elmaddin-bq-demo.information_schema'
[0m13:44:08.074448 [debug] [ThreadPool]: On elmaddin-bq-demo.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "connection_name": "elmaddin-bq-demo.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `elmaddin-bq-demo`.`analytics`.__TABLES__ tables
    left join `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('stg_orders')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('sample_orders')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('mart_funnels')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('mart_cohort_ltv')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('mart_cohorts')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('stg_events')
                            ) or (
                                upper(table_schema) = upper('analytics')
                            and upper(table_name) = upper('sample_users')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `elmaddin-bq-demo`.`analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:44:08.090570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:08.093547 [debug] [ThreadPool]: On elmaddin-bq-demo.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "connection_name": "elmaddin-bq-demo.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `elmaddin-bq-demo`.`raw`.__TABLES__ tables
    left join `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('events')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('users')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('orders')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `elmaddin-bq-demo`.`raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:44:08.094550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:09.048460 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:bcdbf004-54bf-4dce-886b-9f4c6588fd93&page=queryresults
[0m13:44:09.056537 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:24eb9070-a4bd-4c9e-8d80-c70700582bd1&page=queryresults
[0m13:44:11.174473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:11.189655 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\catalog.json
[0m13:44:11.218656 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:44:11.221696 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:44:11.221696 [info ] [MainThread]: Catalog written to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\catalog.json
[0m13:44:11.223618 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:44:11.223618 after 10.94 seconds
[0m13:44:11.223618 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:44:11.223618 [debug] [MainThread]: Connection 'elmaddin-bq-demo.information_schema' was properly closed.
[0m13:44:11.224700 [debug] [MainThread]: Connection 'elmaddin-bq-demo.information_schema' was properly closed.
[0m13:44:11.224700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E6666350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D486620940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4866A10C0>]}
[0m13:44:11.224700 [debug] [MainThread]: Flushing usage events
[0m13:44:11.869097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:19.903162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C73906320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C74C8FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C74C8FF10>]}


============================== 13:44:19.906124 | 698b373d-a78b-49f6-8bec-36b8877bbb8f ==============================
[0m13:44:19.906124 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:44:19.907142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt run --select mart_cohort_ltv', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m13:44:23.258940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '698b373d-a78b-49f6-8bec-36b8877bbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C70CDD390>]}
[0m13:44:23.338634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '698b373d-a78b-49f6-8bec-36b8877bbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C73C53010>]}
[0m13:44:23.339635 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:44:23.832220 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:44:24.073374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:24.073374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:24.141185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '698b373d-a78b-49f6-8bec-36b8877bbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C120ABF40>]}
[0m13:44:24.272422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:44:24.275337 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:44:24.300017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '698b373d-a78b-49f6-8bec-36b8877bbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C12053E20>]}
[0m13:44:24.300017 [info ] [MainThread]: Found 5 models, 8 data tests, 2 seeds, 3 sources, 705 macros
[0m13:44:24.301017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698b373d-a78b-49f6-8bec-36b8877bbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C120530D0>]}
[0m13:44:24.302032 [info ] [MainThread]: 
[0m13:44:24.303015 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:24.303015 [info ] [MainThread]: 
[0m13:44:24.303998 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:44:24.304998 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo'
[0m13:44:24.304998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:24.988571 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:44:24.988571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:25.715114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698b373d-a78b-49f6-8bec-36b8877bbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C70C6BFD0>]}
[0m13:44:25.715114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:25.720386 [debug] [Thread-1 (]: Began running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:44:25.720386 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.mart_cohort_ltv ......................... [RUN]
[0m13:44:25.721385 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_ecom_profile.mart_cohort_ltv'
[0m13:44:25.722384 [debug] [Thread-1 (]: Began compiling node model.bq_ecom_profile.mart_cohort_ltv
[0m13:44:25.733410 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:44:25.734918 [debug] [Thread-1 (]: Began executing node model.bq_ecom_profile.mart_cohort_ltv
[0m13:44:25.750569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:44:26.479535 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_ecom_profile.mart_cohort_ltv"
[0m13:44:26.481445 [debug] [Thread-1 (]: On model.bq_ecom_profile.mart_cohort_ltv: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "model.bq_ecom_profile.mart_cohort_ltv"} */

  
    

    create or replace table `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
      
    
    

    
    OPTIONS()
    as (
      

WITH user_orders AS (
    SELECT
        user_id,
        DATE_TRUNC(order_ts, DAY) AS order_date,
        order_ts,
        total_amount AS revenue
    FROM `elmaddin-bq-demo`.`raw`.`orders`
),

cohorts AS (
    SELECT
        user_id,
        MIN(DATE_TRUNC(order_ts, DAY)) AS cohort_date
    FROM `elmaddin-bq-demo`.`raw`.`orders`
    GROUP BY 1
),

ltv_calc AS (
    SELECT
        c.cohort_date,
        DATE_DIFF(DATE_TRUNC(u.order_ts, DAY), c.cohort_date, DAY) AS day_offset,
        COUNT(DISTINCT u.user_id) AS active_users,
        SUM(u.revenue) AS revenue
    FROM user_orders u
    JOIN cohorts c
      ON u.user_id = c.user_id
    GROUP BY 1, 2
)

SELECT
    l.cohort_date,
    l.day_offset,
    l.active_users,
    SAFE_DIVIDE(l.revenue, NULLIF(l.active_users, 0)) AS avg_ltv_per_user,
    l.revenue
FROM ltv_calc l
ORDER BY l.cohort_date, l.day_offset
    );
  
[0m13:44:27.092820 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:76a370fa-d2e5-4022-ae79-fb0404650810&page=queryresults
[0m13:44:29.451721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698b373d-a78b-49f6-8bec-36b8877bbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0BA068F0>]}
[0m13:44:29.452815 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.mart_cohort_ltv .................... [[32mCREATE TABLE (3.0 rows, 60.0 Bytes processed)[0m in 3.73s]
[0m13:44:29.453769 [debug] [Thread-1 (]: Finished running node model.bq_ecom_profile.mart_cohort_ltv
[0m13:44:29.455728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:29.456727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:29.457743 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo' was properly closed.
[0m13:44:29.457743 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:44:29.458728 [debug] [MainThread]: Connection 'model.bq_ecom_profile.mart_cohort_ltv' was properly closed.
[0m13:44:29.458728 [info ] [MainThread]: 
[0m13:44:29.458728 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m13:44:29.459727 [debug] [MainThread]: Command end result
[0m13:44:29.491408 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:44:29.494409 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:44:29.501506 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:44:29.501506 [info ] [MainThread]: 
[0m13:44:29.502426 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:29.503408 [info ] [MainThread]: 
[0m13:44:29.503408 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:44:29.504406 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:29.504406 after 9.69 seconds
[0m13:44:29.504406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C73906320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C117822C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C73C53010>]}
[0m13:44:29.505435 [debug] [MainThread]: Flushing usage events
[0m13:44:30.251326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:35.190391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162B4256350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162B55DFBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162B55DFDC0>]}


============================== 13:44:35.194416 | dd64de1e-5852-417b-b499-22618f9f9bba ==============================
[0m13:44:35.194416 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:44:35.195414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt test --select mart_cohort_ltv', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True'}
[0m13:44:38.633079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd64de1e-5852-417b-b499-22618f9f9bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162D0F49240>]}
[0m13:44:38.720343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd64de1e-5852-417b-b499-22618f9f9bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162B55DDF00>]}
[0m13:44:38.721354 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:44:39.223540 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:44:39.441575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:39.441575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:39.512681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd64de1e-5852-417b-b499-22618f9f9bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162D27F4DF0>]}
[0m13:44:39.641536 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:44:39.644503 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:44:39.677553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd64de1e-5852-417b-b499-22618f9f9bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162D27F52A0>]}
[0m13:44:39.678533 [info ] [MainThread]: Found 5 models, 8 data tests, 2 seeds, 3 sources, 705 macros
[0m13:44:39.678533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd64de1e-5852-417b-b499-22618f9f9bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162D27F7700>]}
[0m13:44:39.680535 [info ] [MainThread]: 
[0m13:44:39.681532 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:39.681532 [info ] [MainThread]: 
[0m13:44:39.682530 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:44:39.687579 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_elmaddin-bq-demo_analytics'
[0m13:44:39.688580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:40.399448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd64de1e-5852-417b-b499-22618f9f9bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162D0EF8250>]}
[0m13:44:40.400410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:40.407425 [debug] [Thread-1 (]: Began running node test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e
[0m13:44:40.407425 [debug] [Thread-2 (]: Began running node test.bq_ecom_profile.no_negative_revenue
[0m13:44:40.407425 [debug] [Thread-3 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:44:40.408424 [debug] [Thread-4 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:44:40.408424 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset  [RUN]
[0m13:44:40.410824 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e'
[0m13:44:40.410824 [debug] [Thread-1 (]: Began compiling node test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e
[0m13:44:40.409435 [info ] [Thread-2 (]: 2 of 6 START test no_negative_revenue .......................................... [RUN]
[0m13:44:40.428713 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.bq_ecom_profile.no_negative_revenue'
[0m13:44:40.409435 [info ] [Thread-3 (]: 3 of 6 START test not_null_mart_cohort_ltv_active_users ........................ [RUN]
[0m13:44:40.432689 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e"
[0m13:44:40.432689 [debug] [Thread-2 (]: Began compiling node test.bq_ecom_profile.no_negative_revenue
[0m13:44:40.410425 [info ] [Thread-4 (]: 4 of 6 START test not_null_mart_cohort_ltv_cohort_date ......................... [RUN]
[0m13:44:40.433689 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b'
[0m13:44:40.437770 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_ecom_profile.no_negative_revenue"
[0m13:44:40.438757 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d'
[0m13:44:40.439381 [debug] [Thread-3 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:44:40.439922 [debug] [Thread-4 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:44:40.440934 [debug] [Thread-1 (]: Began executing node test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e
[0m13:44:40.449947 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b"
[0m13:44:40.453946 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d"
[0m13:44:40.454946 [debug] [Thread-2 (]: Began executing node test.bq_ecom_profile.no_negative_revenue
[0m13:44:40.476172 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e"
[0m13:44:40.480162 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_ecom_profile.no_negative_revenue"
[0m13:44:40.480162 [debug] [Thread-3 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:44:40.481142 [debug] [Thread-4 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:44:40.484695 [debug] [Thread-3 (]: Writing runtime sql for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b"
[0m13:44:40.488253 [debug] [Thread-4 (]: Writing runtime sql for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d"
[0m13:44:40.489255 [debug] [Thread-2 (]: On test.bq_ecom_profile.no_negative_revenue: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "test.bq_ecom_profile.no_negative_revenue"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select cohort_date, day_offset, revenue
from `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
where revenue < 0
  
  
      
    ) dbt_internal_test
[0m13:44:40.489255 [debug] [Thread-1 (]: On test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        cohort_date, day_offset
    from `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
    group by cohort_date, day_offset
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:44:40.490256 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:44:40.491253 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:44:40.492256 [debug] [Thread-3 (]: On test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select active_users
from `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
where active_users is null



  
  
      
    ) dbt_internal_test
[0m13:44:40.492256 [debug] [Thread-4 (]: On test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cohort_date
from `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
where cohort_date is null



  
  
      
    ) dbt_internal_test
[0m13:44:40.493254 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:44:40.495254 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:44:41.552961 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:53dab218-0349-4327-9a16-178e09774eaa&page=queryresults
[0m13:44:41.564030 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:d6854c7e-31f3-488c-8cbb-545ef20517a2&page=queryresults
[0m13:44:41.566255 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:b2ba2338-2a40-476c-bb60-53216b84435c&page=queryresults
[0m13:44:41.600594 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:163ace3f-b7f6-4891-b1bd-d62e4def756b&page=queryresults
[0m13:44:42.563856 [info ] [Thread-2 (]: 2 of 6 PASS no_negative_revenue ................................................ [[32mPASS[0m in 2.13s]
[0m13:44:42.563856 [debug] [Thread-2 (]: Finished running node test.bq_ecom_profile.no_negative_revenue
[0m13:44:42.564958 [debug] [Thread-2 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:44:42.564958 [info ] [Thread-2 (]: 5 of 6 START test not_null_mart_cohort_ltv_day_offset .......................... [RUN]
[0m13:44:42.565858 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.no_negative_revenue, now test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce)
[0m13:44:42.565858 [debug] [Thread-2 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:44:42.570978 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce"
[0m13:44:42.573939 [info ] [Thread-3 (]: 3 of 6 PASS not_null_mart_cohort_ltv_active_users .............................. [[32mPASS[0m in 2.14s]
[0m13:44:42.575939 [debug] [Thread-3 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b
[0m13:44:42.575939 [debug] [Thread-2 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:44:42.576939 [debug] [Thread-3 (]: Began running node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:44:42.577966 [info ] [Thread-4 (]: 4 of 6 PASS not_null_mart_cohort_ltv_cohort_date ............................... [[32mPASS[0m in 2.14s]
[0m13:44:42.580954 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce"
[0m13:44:42.581940 [debug] [Thread-4 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d
[0m13:44:42.580954 [info ] [Thread-3 (]: 6 of 6 START test not_null_mart_cohort_ltv_revenue ............................. [RUN]
[0m13:44:42.582939 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bq_ecom_profile.not_null_mart_cohort_ltv_active_users.7ab88d2d5b, now test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac)
[0m13:44:42.582939 [debug] [Thread-3 (]: Began compiling node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:44:42.586975 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac"
[0m13:44:42.587974 [debug] [Thread-2 (]: On test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_offset
from `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
where day_offset is null



  
  
      
    ) dbt_internal_test
[0m13:44:42.588974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:44:42.613975 [debug] [Thread-3 (]: Began executing node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:44:42.616974 [debug] [Thread-3 (]: Writing runtime sql for node "test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac"
[0m13:44:42.618976 [debug] [Thread-3 (]: On test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bq_ecom_profile", "target_name": "dev", "node_id": "test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue
from `elmaddin-bq-demo`.`analytics`.`mart_cohort_ltv`
where revenue is null



  
  
      
    ) dbt_internal_test
[0m13:44:42.618976 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:44:42.647108 [info ] [Thread-1 (]: 1 of 6 PASS dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset  [[32mPASS[0m in 2.24s]
[0m13:44:42.648108 [debug] [Thread-1 (]: Finished running node test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e
[0m13:44:43.711446 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:3fa5af33-079b-462f-a51a-cc1b504f8c7c&page=queryresults
[0m13:44:43.724529 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=elmaddin-bq-demo&j=bq:US:9649cdf0-540a-4455-87bb-8fb999875828&page=queryresults
[0m13:44:44.669884 [info ] [Thread-3 (]: 6 of 6 PASS not_null_mart_cohort_ltv_revenue ................................... [[32mPASS[0m in 2.09s]
[0m13:44:44.670890 [debug] [Thread-3 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac
[0m13:44:44.817292 [info ] [Thread-2 (]: 5 of 6 PASS not_null_mart_cohort_ltv_day_offset ................................ [[32mPASS[0m in 2.25s]
[0m13:44:44.818233 [debug] [Thread-2 (]: Finished running node test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce
[0m13:44:44.819180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:44.821270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:44.821270 [debug] [MainThread]: Connection 'list_elmaddin-bq-demo_analytics' was properly closed.
[0m13:44:44.821270 [debug] [MainThread]: Connection 'test.bq_ecom_profile.dbt_utils_unique_combination_of_columns_mart_cohort_ltv_cohort_date__day_offset.adbc18893e' was properly closed.
[0m13:44:44.822279 [debug] [MainThread]: Connection 'test.bq_ecom_profile.not_null_mart_cohort_ltv_day_offset.850b2cb3ce' was properly closed.
[0m13:44:44.822279 [debug] [MainThread]: Connection 'test.bq_ecom_profile.not_null_mart_cohort_ltv_revenue.8711bffaac' was properly closed.
[0m13:44:44.822279 [debug] [MainThread]: Connection 'test.bq_ecom_profile.not_null_mart_cohort_ltv_cohort_date.f1827ee09d' was properly closed.
[0m13:44:44.822279 [info ] [MainThread]: 
[0m13:44:44.823278 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m13:44:44.825187 [debug] [MainThread]: Command end result
[0m13:44:44.857898 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\manifest.json
[0m13:44:44.860898 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\semantic_manifest.json
[0m13:44:44.868094 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Huawei\GitHub Repositories\bq-analysis\dbt\target\run_results.json
[0m13:44:44.868094 [info ] [MainThread]: 
[0m13:44:44.869006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:44.869006 [info ] [MainThread]: 
[0m13:44:44.870081 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m13:44:44.871011 [debug] [MainThread]: Command `dbt test` succeeded at 13:44:44.871011 after 9.77 seconds
[0m13:44:44.872014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162B4256350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162B55DDF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162B45D2D40>]}
[0m13:44:44.872014 [debug] [MainThread]: Flushing usage events
[0m13:44:45.490803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:56.113481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209135E6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002091496BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002091496BF70>]}


============================== 13:44:56.117477 | 6e7b7d28-c7df-4ea1-bc18-a12f4f5bb1b3 ==============================
[0m13:44:56.117477 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:44:56.117477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'C:\\Users\\Huawei\\GitHub Repositories\\bq-analysis\\dbt\\logs', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m13:44:59.231970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e7b7d28-c7df-4ea1-bc18-a12f4f5bb1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092B4C9360>]}
[0m13:44:59.305545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e7b7d28-c7df-4ea1-bc18-a12f4f5bb1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002091393AB90>]}
[0m13:44:59.405848 [error] [MainThread]: Encountered an error:
[WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted
[0m13:44:59.441131 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\socketserver.py", line 452, in __init__
    self.server_bind()
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted

[0m13:44:59.443129 [debug] [MainThread]: Command `dbt docs serve` failed at 13:44:59.443129 after 3.42 seconds
[0m13:44:59.444133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209135E6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209315602E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020931560310>]}
[0m13:44:59.444133 [debug] [MainThread]: Flushing usage events
[0m13:45:00.084539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:07.907339 [error] [MainThread]: Encountered an error:

[0m14:07:07.936422 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\Huawei\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m14:07:07.947058 [debug] [MainThread]: Command `dbt docs serve` failed at 14:07:07.947058 after 5368.53 seconds
[0m14:07:07.949060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232320162F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002324FF804C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002324FF80610>]}
[0m14:07:07.950059 [debug] [MainThread]: Flushing usage events
[0m14:07:08.658425 [debug] [MainThread]: An error was encountered while trying to flush usage events
