version: 2

models:
  - name: mart_cohort_ltv
    description: "Cohort LTV by cohort_date and day_offset (first purchase as cohort)."
    columns:
      - name: cohort_date
        description: "Cohort date (first purchase date truncated to day)."
        tests:
          - not_null
      - name: day_offset
        description: "Days since cohort_date"
        tests:
          - not_null
      - name: active_users
        description: "Number of distinct users active on this day_offset"
        tests:
          - not_null
      - name: revenue
        description: "Revenue aggregated for this cohort and day_offset"
        tests:
          - not_null
    data_tests:
      - dbt_utils.unique_combination_of_columns:
          arguments:
            combination_of_columns:
              - cohort_date
              - day_offset